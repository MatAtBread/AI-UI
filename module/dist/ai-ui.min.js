"use strict";var AIUI=(()=>{var he=Object.defineProperty;var Fe=Object.getOwnPropertyDescriptor;var $e=Object.getOwnPropertyNames;var Ve=Object.prototype.hasOwnProperty;var ke=(e,t)=>{for(var n in t)he(e,n,{get:t[n],enumerable:!0})},Ge=(e,t,n,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let c of $e(t))!Ve.call(e,c)&&c!==n&&he(e,c,{get:()=>t[c],enumerable:!(a=Fe(t,c))||a.enumerable});return e};var Qe=e=>Ge(he({},"__esModule",{value:!0}),e);var yt={};ke(yt,{Iterators:()=>Pe,UniqueID:()=>ye,tag:()=>Le,when:()=>me});var C=globalThis.DEBUG=="*"||globalThis.DEBUG==!0||!!globalThis.DEBUG?.match(/(^|\W)AI-UI(\W|$)/)||!1;var J=5e3,I={log(...e){C&&console.log("(AI-UI) LOG:",...e,new Error().stack?.replace(/Error\n\s*.*\n/,`
`))},warn(...e){C&&console.warn("(AI-UI) WARN:",...e,new Error().stack?.replace(/Error\n\s*.*\n/,`
`))},info(...e){C&&console.trace("(AI-UI) INFO:",...e)}};var Ne=e=>{};function Te(){let e=Ne,t=Ne,n=new Promise((...a)=>[e,t]=a);if(n.resolve=e,n.reject=t,C){let a=new Error().stack;n.catch(c=>c instanceof Error||c?.value instanceof Error?I.log("Deferred rejection",c,"allocated at ",a):void 0)}return n}function le(e){return e&&typeof e=="object"||typeof e=="function"}function X(e){return le(e)&&"then"in e&&typeof e.then=="function"}var Pe={};ke(Pe,{Ignore:()=>R,Iterability:()=>re,asyncExtras:()=>ce,asyncIterator:()=>ve,augmentGlobalAsyncGenerators:()=>rt,combine:()=>je,debounceQueueIteratableIterator:()=>Re,defineIterableProperty:()=>Ee,filterMap:()=>_,generatorHelpers:()=>_e,isAsyncIter:()=>Q,isAsyncIterable:()=>ue,isAsyncIterator:()=>ae,iterableHelpers:()=>q,merge:()=>de,queueIteratableIterator:()=>xe});var re=Symbol("Iterability");function ae(e){return le(e)&&"next"in e&&typeof e?.next=="function"}function ue(e){return le(e)&&Symbol.asyncIterator in e&&typeof e[Symbol.asyncIterator]=="function"}function Q(e){return ue(e)||ae(e)}function ve(e){if(ae(e))return e;if(ue(e))return e[Symbol.asyncIterator]();throw new Error("Not an async provider")}var ce={filterMap(e,t=R){return _(this,e,t)},map:Ze,filter:Je,unique:ze,waitFor:tt,multi:nt,initially:et,consume:Be,merge(...e){return de(this,...e)},combine(e){return je(Object.assign({_this:this},e))}},Ie=[...Object.getOwnPropertySymbols(ce),...Object.keys(ce)];function be(e,t){let n=[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)];for(let a of n)Object.defineProperty(e,a,{...Object.getOwnPropertyDescriptor(t,a),enumerable:!1});return e}var H=Symbol("pending"),G=Symbol("items");function Me(e=()=>{}){let t={[H]:[],[G]:[],[Symbol.asyncIterator](){return t},next(){if(t[G]?.length)return Promise.resolve(t[G].shift());if(!t[H])return Promise.resolve({done:!0,value:void 0});let n=Te();return n.catch(a=>{}),t[H].unshift(n),n},return(n){let a={done:!0,value:void 0};if(t[H]){try{e()}catch{}for(;t[H].length;)t[H].pop().resolve(a);t[G]=t[H]=null}return Promise.resolve(a)},throw(...n){let a={done:!0,value:n[0]};if(t[H]){try{e()}catch{}for(;t[H].length;)t[H].pop().reject(a);t[G]=t[H]=null}return Promise.reject(a)},get length(){return t[G]?t[G].length:-1},push(n){return t[H]?(t[H].length?t[H].pop().resolve({done:!1,value:n}):t[G]?t[G].push({done:!1,value:n}):I.log("Discarding queue push as there are no consumers"),!0):!1}};return q(t)}var pe=Symbol("inflight");function qe(e=()=>{}){let t=Me(e);return t[pe]=new Set,t.push=function(n){if(!t[H])return!1;if(t[pe].has(n))return!0;if(t[H].length){t[pe].add(n);let a=t[H].pop();a.finally(()=>t[pe].delete(n)),a.resolve({done:!1,value:n})}else t[G]?t[G].find(a=>a.value===n)||t[G].push({done:!1,value:n}):I.log("Discarding queue push as there are no consumers");return!0},t}var xe=Me,Re=qe,ne=Symbol("_proxiedAsyncIterator");function Ee(e,t,n){let a=()=>{a=()=>K;let b=Re(),A=b.multi(),K=A[Symbol.asyncIterator]();return y[Symbol.asyncIterator]=A[Symbol.asyncIterator],l=b.push,Ie.forEach(k=>y[k]=K[k]),ne in o||be(o,y),K};function c(b){return{[b]:function(...A){return a(),o[b].apply(this,A)}}[b]}let y={[Symbol.asyncIterator]:a};Ie.forEach(b=>y[b]=c(b)),typeof n=="object"&&n&&re in n&&n[re]==="shallow"&&(y[re]=n[re]);let l=b=>(a(),l(b)),o=p(n,y),i;return Object.defineProperty(e,t,{get(){return o},set(b){if(b!==o)if(ue(b)){if(i===b)return;i=b;let A=C?new Error:void 0;C&&I.info(new Error(`Iterable "${t.toString()}" has been assigned to consume another iterator. Did you mean to declare it?`)),Be.call(b,K=>{if(b!==i)throw new Error(`Piped iterable "${t.toString()}" has been replaced by another iterator`,{cause:A});l(K?.valueOf())}).catch(K=>I.info(K)).finally(()=>b===i&&(i=void 0));return}else i&&C&&I.log(`Iterable "${t.toString()}" is already piped from another iterator, and might be overrwitten later`),o=p(b,y);l(b?.valueOf())},enumerable:!0}),e;function p(b,A){if(b==null)return be(Object.create(null,{valueOf:{value(){return b},writable:!0,configurable:!0},toJSON:{value(){return b},writable:!0,configurable:!0}}),A);switch(typeof b){case"bigint":case"boolean":case"number":case"string":return be(Object(b),Object.assign(A,{toJSON(){return b.valueOf()}}));case"object":return fe(b,A)}throw new TypeError('Iterable properties cannot be of type "'+typeof b+'"')}function g(b){return le(b)&&ne in b}function B(b,A){let K=A.split(".").slice(1);for(let k=0;k<K.length&&(b=b?.[K[k]])!==void 0;k++);return b}function fe(b,A){let K,k;return new Proxy(b,se());function se(L=""){return{has(D,P){return P===ne||P===Symbol.toPrimitive||P in D||P in A},set(D,P,F,j){if(Object.hasOwn(A,P))throw new Error(`Cannot set ${t.toString()}${L}.${P.toString()} as it is part of asyncIterator`);return Reflect.get(D,P,j)!==F&&l({[ne]:{a:b,path:L}}),Reflect.set(D,P,F,j)},deleteProperty(D,P){return Reflect.deleteProperty(D,P)?(l({[ne]:{a:b,path:L}}),!0):!1},get(D,P,F){if(Object.hasOwn(A,P))return L.length?(K??(K=_(A,s=>g(s)?s[ne]:{a:s,path:null})),_(K,(s,u)=>{let h=B(s.a,L);return u!==h||s.path===null||s.path.startsWith(L)?h:R},R,B(b,L))[P]):(k??(k=_(A,j=>g(j)?j[ne].a:j)),k[P]);if(P==="valueOf")return()=>B(b,L);if(P===Symbol.toPrimitive)return function(j){return Reflect.has(D,P)?Reflect.get(D,P,D).call(D,j):j==="string"?D.toString():j==="number"?Number(D):D.valueOf()};if(typeof P=="string"&&(!(P in D)||Object.hasOwn(D,P))&&!(re in D&&D[re]==="shallow")){let j=Reflect.get(D,P,F);return typeof j=="function"||Q(j)?j:new Proxy(Object(j),se(L+"."+P))}return Reflect.get(D,P,F)}}}}}var te=new Promise(()=>{}),de=(...e)=>{let t=new Array(e.length),n=new Array(e.length),a=()=>{a=()=>{};for(let o=0;o<e.length;o++){let i=e[o];n[o]=(t[o]=Symbol.asyncIterator in i?i[Symbol.asyncIterator]():i).next().then(p=>({idx:o,result:p}))}},c=[],y=n.length,l={[Symbol.asyncIterator](){return l},next(){return a(),y?Promise.race(n).then(({idx:o,result:i})=>i.done?(y--,n[o]=te,c[o]=i.value,l.next()):(n[o]=t[o]?t[o].next().then(p=>({idx:o,result:p})).catch(p=>({idx:o,result:{done:!0,value:p}})):Promise.resolve({idx:o,result:{done:!0,value:void 0}}),i)).catch(o=>l.throw?.(o)??Promise.reject({done:!0,value:new Error("Iterator merge exception")})):Promise.resolve({done:!0,value:c})},async return(o){for(let i=0;i<t.length;i++)n[i]!==te&&(n[i]=te,c[i]=await t[i]?.return?.({done:!0,value:o}).then(p=>p.value,p=>p));return{done:!0,value:c}},async throw(o){for(let i=0;i<t.length;i++)n[i]!==te&&(n[i]=te,c[i]=await t[i]?.throw?.(o).then(p=>p.value,p=>p));return{done:!0,value:c}}};return q(l)},je=(e,t={})=>{let n={},a,c=[],y=0,l={[Symbol.asyncIterator](){return l},next(){return a===void 0&&(a=Object.entries(e).map(([o,i],p)=>(y+=1,c[p]=i[Symbol.asyncIterator](),c[p].next().then(g=>({si:c,idx:p,k:o,ir:g}))))),function o(){return Promise.race(a).then(({idx:i,k:p,ir:g})=>g.done?(a[i]=te,y-=1,y?o():{done:!0,value:void 0}):(n[p]=g.value,a[i]=c[i].next().then(B=>({idx:i,k:p,ir:B})),t.ignorePartial&&Object.keys(n).length<Object.keys(e).length?o():{done:!1,value:n}))}()},return(o){return a.forEach((i,p)=>{i!==te&&c[p].return?.(o)}),Promise.resolve({done:!0,value:o})},throw(o){return a.forEach((i,p)=>{i!==te&&c[p].throw?.(o)}),Promise.reject({done:!0,value:o})}};return q(l)};function Xe(e){return ue(e)&&Ie.every(t=>t in e&&e[t]===ce[t])}function q(e){return Xe(e)||be(e,ce),e}function _e(e){return function(...t){let n=e(...t);return q(n)}}async function Be(e){let t;for await(let n of this)t=e?.(n);await t}var R=Symbol("Ignore");function Ye(e,t,n){if(X(e))return e.then(t,n);try{return t(e)}catch(a){return n(a)}}function _(e,t,n=R,a=R){let c,y={[Symbol.asyncIterator](){return y},next(...l){if(n!==R){let o=Promise.resolve({done:!1,value:n});return n=R,o}return new Promise(function o(i,p){c||(c=e[Symbol.asyncIterator]()),c.next(...l).then(g=>g.done?(a=R,i(g)):Ye(t(g.value,a),B=>B===R?o(i,p):i({done:!1,value:a=B}),B=>{a=R,c.throw?c.throw(B):c.return?.(B),p({done:!0,value:B})}),g=>{a=R,p({done:!0,value:g})}).catch(g=>{a=R,c.throw?c.throw(g):c.return?.(g),p({done:!0,value:g})})})},throw(l){return Promise.resolve(c?.throw?c.throw(l):c?.return?.(l)).then(o=>({done:!0,value:o?.value}))},return(l){return Promise.resolve(c?.return?.(l)).then(o=>({done:!0,value:o?.value}))}};return q(y)}function Ze(e){return _(this,e)}function Je(e){return _(this,async t=>await e(t)?t:R)}function ze(e){return e?_(this,async(t,n)=>n===R||await e(t,n)?t:R):_(this,(t,n)=>t===n?R:t)}function et(e){return _(this,t=>t,e)}function tt(e){return _(this,t=>new Promise(n=>(e(()=>n(t)),t)))}function nt(){let e=this,t=0,n,a;function c(l){l&&n.resolve(l),l?.done?n=null:(n=Te(),a.next().then(c).catch(o=>{n.reject({done:!0,value:o}),n=null}))}let y={[Symbol.asyncIterator](){return t+=1,y},next(){return a||(a=e[Symbol.asyncIterator](),c()),n},throw(l){if(t<1)throw new Error("AsyncIterator protocol error");return t-=1,t?Promise.resolve({done:!0,value:l}):Promise.resolve(a?.throw?a.throw(l):a?.return?.(l)).then(o=>({done:!0,value:o?.value}))},return(l){if(t<1)throw new Error("AsyncIterator protocol error");return t-=1,t?Promise.resolve({done:!0,value:l}):Promise.resolve(a?.return?.(l)).then(o=>({done:!0,value:o?.value}))}};return q(y)}function rt(){let e=async function*(){}();for(;e;){if(Object.getOwnPropertyDescriptor(e,Symbol.asyncIterator)){q(e);break}e=Object.getPrototypeOf(e)}e||I.warn("Failed to augment the prototype of `(async function*())()`")}var ee=new WeakMap;function ot(e){ee.has(this)||ee.set(this,new Map);let t=ee.get(this).get(e.type);if(t)for(let n of t)try{let{push:a,terminate:c,containerRef:y,selector:l,includeChildren:o}=n,i=y.deref();if(!i||!i.isConnected){let p="Container `#"+i?.id+">"+(l||"")+"` removed from DOM. Removing subscription";t.delete(n),c(new Error(p))}else if(e.target instanceof Node)if(l){let p=i.querySelectorAll(l);for(let g of p)(o?g.contains(e.target):e.target===g)&&i.contains(g)&&a(e)}else(o?i.contains(e.target):e.target===i)&&a(e)}catch(a){I.warn("docEventHandler",a)}}function Ae(e){return!!(e&&(e.startsWith("#")||e.startsWith(".")||e.startsWith("[")&&e.endsWith("]")))}function He(e){let t=!e||!e.endsWith(">");return{includeChildren:t,selector:t?e:e.slice(0,-1)}}function we(e){let t=e.split(":");if(t.length===1)return Ae(t[0])?[He(t[0]),"change"]:[{includeChildren:!0,selector:null},t[0]];if(t.length===2&&Ae(t[1])&&!Ae(t[0]))return[He(t[1]),t[0]]}function st(e){throw new Error(e)}function Ce(e,t){let[{includeChildren:n,selector:a},c]=we(t)??st("Invalid WhenSelector: "+t);ee.has(e.ownerDocument)||ee.set(e.ownerDocument,new Map),ee.get(e.ownerDocument).has(c)||(e.ownerDocument.addEventListener(c,ot,{passive:!0,capture:!0}),ee.get(e.ownerDocument).set(c,new Set));let y=xe(()=>ee.get(e.ownerDocument)?.get(c)?.delete(l)),l={push:y.push,terminate(o){y.return?.(o)},containerRef:new WeakRef(e),includeChildren:n,selector:a};return Ke(e,a?[a]:void 0).then(o=>ee.get(e.ownerDocument)?.get(c).add(l)),y.multi()}async function*at(){return I.log("doneImmediately"),void 0}function Oe(e){function t(n){return e.map(n)}return Object.assign(q(t),{[Symbol.asyncIterator]:()=>e[Symbol.asyncIterator]()})}function it(e){if(!e)throw new Error(`Falsy async source will never be ready

`+JSON.stringify(e));return typeof e=="string"&&e[0]!=="@"&&!!we(e)}async function*lt(e){yield e}function me(e,...t){if(!t||t.length===0)return Oe(Ce(e,"change"));let n=t.filter(y=>typeof y!="string"||y[0]!=="@").map(y=>typeof y=="string"?Ce(e,y):y instanceof Element?Ce(y,"change"):X(y)?lt(y):y);if(t.includes("@start")){let y={[Symbol.asyncIterator]:()=>y,next(){return y.next=()=>Promise.resolve({done:!0,value:void 0}),Promise.resolve({done:!1,value:{}})}};n.push(y)}if(t.includes("@ready")){let l=function(g){return typeof g=="string"&&!e.querySelector(g)};var c=l;let o=t.filter(it).map(g=>we(g)?.[0]).map(g=>g?.selector).filter(l),i,p={[Symbol.asyncIterator](){return p},throw(g){return i?.throw?i.throw(g):Promise.resolve({done:!0,value:g})},return(g){return i?.return?i.return(g):Promise.resolve({done:!0,value:g})},next(){return i?i.next():Ke(e,o).then(()=>(i=(n.length>1?de(...n):n.length===1?n[0]:void 0)?.[Symbol.asyncIterator](),i?{done:!1,value:{}}:{done:!0,value:void 0}))}};return Oe(q(p))}let a=n.length>1?de(...n):n.length===1?n[0]:at();return Oe(q(a))}function Ke(e,t){function n(){if(e.isConnected)return Promise.resolve();let c,y=new Promise((l,o)=>(c=o,new MutationObserver((i,p)=>{i.some(g=>g.addedNodes?.length)&&e.isConnected&&(p.disconnect(),l()),i.some(g=>[...g.removedNodes].includes(e))&&(p.disconnect(),o(new Error("Removed from DOM")))}).observe(e.ownerDocument.body,{subtree:!0,childList:!0})));if(C){let l=new Error().stack?.replace(/^Error/,`Element not mounted after ${J/1e3} seconds:`),o=setTimeout(()=>{I.warn(l+`
`+e.outerHTML)},J);y.finally(()=>clearTimeout(o))}return y}function a(c){if(c=c.filter(l=>!e.querySelector(l)),!c.length)return Promise.resolve();let y=new Promise(l=>new MutationObserver((o,i)=>{o.some(p=>p.addedNodes?.length)&&c.every(p=>e.querySelector(p))&&(i.disconnect(),l())}).observe(e,{subtree:!0,childList:!0}));if(C){let l=new Error().stack?.replace(/^Error/,`Missing selectors after ${J/1e3} seconds: `)??"??",o=setTimeout(()=>{I.warn(l+c+`
`)},J);y.finally(()=>clearTimeout(o))}return y}return t?.length?n().then(()=>a(t)):n()}var ie=Symbol("callStack");var ye=Symbol("Unique ID"),z=C?e=>`"${"innerHTML"in e?e.innerHTML:e.textContent}"`:e=>{},ct=0,ut=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","menu","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","script","search","section","select","slot","small","source","span","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"];function oe(){throw new Error("<elt>.ids is a read-only map of Elements")}var We=[...Object.keys(Object.getOwnPropertyDescriptors(Function.prototype))].reduce((e,t)=>(e[t]=Symbol(t),e),{});function Ue(e){return e in We?We[e]:e}function ge(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||e instanceof Node||e instanceof NodeList||e instanceof HTMLCollection||e===null||e===void 0||Array.isArray(e)||X(e)||Q(e)||typeof e=="object"&&Symbol.iterator in e&&typeof e[Symbol.iterator]=="function"}var Le=function(e,t,n){let[a,c,y]=typeof e=="string"||e===null?[e,t,n]:Array.isArray(e)?[null,e,t]:[null,ut,e],l=y?.commonProperties,o=y?.document??globalThis.document,i=dt(o,"removedNodes",y?.enableOnRemovedFromDOM);function p(){return o.createComment(C&&new Error("promise").stack?.replace(/^Error: /,"")||"promise")}function g({error:s}){return o.createComment(s instanceof Error?s.toString():`Error:
`+JSON.stringify(s,null,2))}let B=o.createElement("STYLE");B.id="--ai-ui-extended-tag-styles-"+Date.now();let fe=new Set,b=Object.create(null,{when:{writable:!1,configurable:!0,enumerable:!1,value:function(...s){return me(this,...s)}},attributes:{...Object.getOwnPropertyDescriptor(Element.prototype,"attributes"),set(s){if(Q(s)){let u=ae(s)?s:s[Symbol.asyncIterator](),h=()=>u.next().then(({done:r,value:T})=>{L(this,T),r||h()},r=>I.warn(r));h()}else L(this,s)}},ids:{configurable:!0,enumerable:!0,set:oe,get(){let s=new Proxy(()=>{},{apply(u,h,r){try{return h.constructor.definition.ids[r[0].id](...r)}catch(T){throw new Error(`<elt>.ids.${r?.[0]?.id} is not a tag-creating function`,{cause:T})}},construct:oe,defineProperty:oe,deleteProperty:oe,set:oe,setPrototypeOf:oe,getPrototypeOf(){return null},isExtensible(){return!1},preventExtensions(){return!0},getOwnPropertyDescriptor(u,h){if(this.get(u,h,null))return Reflect.getOwnPropertyDescriptor(u,Ue(h))},has(u,h){return!!this.get(u,h,null)},ownKeys:u=>{let h=[...this.querySelectorAll("[id]")].map(T=>T.id),r=[...new Set(h)];return C&&h.length!==r.length&&I.log("Element contains multiple, shadowed decendant ids",r),r},get:(u,h,r)=>{if(typeof h=="string"){let T=Ue(h);if(T in u){let x=u[T].deref();if(x&&x.id===h&&this.contains(x))return x;delete u[T]}let d;if(C){let x=this.querySelectorAll("#"+CSS.escape(h));x.length>1&&(fe.has(h)||(fe.add(h),I.log(`Element contains multiple, shadowed decendants with ID "${h}"`))),d=x[0]}else d=this.querySelector("#"+CSS.escape(h))??void 0;return d&&Reflect.set(u,T,new WeakRef(d),u),d}}});return Object.defineProperty(this,"ids",{configurable:!0,enumerable:!0,set:oe,get(){return s}}),s}}});l&&k(b,l);function A(...s){let u=[],h=r=>{if(!(r==null||r===R)){if(X(r)){let T=p(),d=x=>{let Y=u.indexOf(T);if(Y<0&&(I.warn("Replacement node not in array of appended nodes! This shouldn't be possible."),C))debugger;i.add(T),u.splice(Y,1,...x),T.replaceWith(...x)};u.push(T),r.then(x=>d(A(x)),x=>{I.warn(x,z(T)),d([g({error:x})])});return}if(r instanceof Node){u.push(r);return}if(r&&typeof r=="object"&&Symbol.iterator in r&&!(Symbol.asyncIterator in r)&&r[Symbol.iterator]){for(let T of r)h(T);return}if(Q(r)){let T=C?`
`+new Error().stack?.replace(/^Error: /,"Insertion :"):"",d=ae(r)?r:r[Symbol.asyncIterator](),x=r.valueOf(),Y=x===void 0||x===r?[]:A(x),m=Y.length?Y:[p()];u.push(...m);let f=E=>{let w=m.map(S=>u.indexOf(S)).sort((S,N)=>N-S);if(w[w.length-1]<0&&(I.warn("Replacement node not in array of appended nodes! This shouldn't be possible."),C))debugger;w.forEach(S=>{S>=0&&(i.add(u[S]),u.splice(S,1))}),E&&(E.length===0&&(E=[p()]),u.splice(Math.min(...w),0,...E)),m=E||[]},v=!0,O=Date.now()+J,V=C&&new Error("Created by").stack,Z=()=>d.next().then(E=>{if(!E.done){let w=m.filter(N=>N?.parentNode&&N.isConnected),S=v?m:w;if(v&&w.length&&(v=!1),!S.length||m.every(N=>i.has(N))){f(null);let N="Element(s) have been removed from the document: "+T;d.return?.(new Error(N));return}C&&v&&O&&O<Date.now()&&(O=Number.MAX_SAFE_INTEGER,I.warn(`Async element not mounted after ${J/1e3} seconds. If it is never mounted, it will leak.`,V,m.map(z))),f(A(se(E.value))),S[0].replaceWith(...m),S.forEach(N=>!m.includes(N)&&N.parentNode?.removeChild(N)),Z()}}).catch(E=>{let w=m.filter(S=>!!S?.parentNode);w.length?(f([g({error:E})]),w[0].replaceWith(...m),w.slice(1).forEach(S=>S?.parentNode.removeChild(S))):I.warn("Can't report error",E,V,m.map(z)),f(null),d.return?.(E)});Z();return}u.push(o.createTextNode(r.toString()))}};return h(s),u}a||Object.assign(Le,{nodes:A,UniqueID:ye});let K=Object.getPrototypeOf({});function k(s,u,h){if(!(u==null||typeof u!="object"||u===s))for(let[r,T]of Object.entries(Object.getOwnPropertyDescriptors(u)))try{if("value"in T){let d=T.value;d&&Q(d)?Object.defineProperty(s,r,T):d&&typeof d=="object"&&!X(d)?r in s?d instanceof Node?(I.info(`Having DOM Nodes as properties of other DOM Nodes is a bad idea as it makes the DOM tree into a cyclic graph. You should reference nodes by ID or via a collection such as .childNodes. Propety: '${r}' value: ${z(d)} destination: ${s instanceof Node?z(s):s}`),s[r]=d):s[r]!==d&&(Array.isArray(s[r])&&s[r].length!==d.length?d.constructor===Object||d.constructor===Array?k(s[r]=new d.constructor,d):s[r]=d:k(s[r],d)):(h&&(Object.getPrototypeOf(d)===K||!Object.getPrototypeOf(d)?k(T.value={},d):Array.isArray(d)?k(T.value=[],d):I.warn(`Declared propety '${r}' is not a plain object and must be assigned by reference, possibly polluting other instances of this tag`,s,d)),Object.defineProperty(s,r,T)):u[r]!==void 0&&(s[r]=u[r])}else Object.defineProperty(s,r,T)}catch(d){throw I.warn("deepAssign",r,u[r],d),d}}function se(s){let u=s?.valueOf();return Array.isArray(u)?Array.prototype.map.call(u,se):u}function L(s,u){ie in u||function h(r,T){if(T==null||typeof T!="object")return;let d=Object.entries(Object.getOwnPropertyDescriptors(T));Array.isArray(T)||d.sort(m=>{let f=Object.getOwnPropertyDescriptor(r,m[0]);if(f){if("value"in f)return-1;if("set"in f||"get"in f)return 1}return 0});for(let[m,f]of d)try{if("value"in f){let v=f.value;Q(v)?x(v,m):X(v)?v.then(O=>{O&&typeof O=="object"?Q(O)?x(O,m):Y(O,m):T[m]!==void 0&&(r[m]=O)},O=>I.log("Failed to set attribute",O)):Q(v)||(v&&typeof v=="object"&&!X(v)?Y(v,m):T[m]!==void 0&&(r[m]=T[m]))}else Object.defineProperty(r,m,f)}catch(v){throw I.warn("assignProps",m,T[m],v),v}function x(m,f){let v=ve(m),O=!0,V=Date.now()+J,Z=C&&new Error("Created by").stack,E=N=>{if(!N.done){let M=se(N.value);if(typeof M=="object"&&M!==null){let W=Object.getOwnPropertyDescriptor(r,f);f==="style"||!W?.set?h(r[f],M):r[f]=M}else M!==void 0&&(r[f]=M);let $=s.isConnected;if(i.has(s)||!O&&!$){I.info(`Element does not exist in document when setting async attribute '${f}' to:
${z(s)}`),v.return?.();return}$&&(O=!1),O&&V&&V<Date.now()&&(V=Number.MAX_SAFE_INTEGER,I.warn(`Element with async attribute '${f}' not mounted after ${J/1e3} seconds. If it is never mounted, it will leak.
Element contains: ${z(s)}
${Z}`)),v.next().then(E).catch(w)}},w=N=>{I.warn("Dynamic attribute error",N,f,r,Z,z(s)),v.return?.(N),s.appendChild(g({error:N}))},S=m.valueOf();S!==void 0&&S!==m&&!Q(S)?E({done:!1,value:S}):v.next().then(E).catch(w)}function Y(m,f){if(m instanceof Node)I.info(`Having DOM Nodes as properties of other DOM Nodes is a bad idea as it makes the DOM tree into a cyclic graph. You should reference nodes by ID or via a collection such as .childNodes. Propety: '${f}' value: ${z(m)} destination: ${s instanceof Node?z(s):s}`),r[f]=m;else if(!(f in r)||r[f]===m||Array.isArray(r[f])&&r[f].length!==m.length)if(m.constructor===Object||m.constructor===Array){let v=new m.constructor;h(v,m),r[f]=v}else r[f]=m;else Object.getOwnPropertyDescriptor(r,f)?.set?r[f]=m:h(r[f],m)}}(s,u)}function D(s){for(let u=s.constructor;u;u=u.super)if(u===this)return!0;return!1}function P(s){let u=typeof s!="function"?f=>Object.assign({},s,f):s,h=Date.now().toString(36)+(ct++).toString(36)+Math.random().toString(36).slice(2),r=u({[ye]:h});r.styles&&(B.appendChild(o.createTextNode(r.styles+`
`)),o.head.contains(B)||o.head.appendChild(B));let d=Object.assign((f,...v)=>{let O=ge(f),V=[],Z={[ie]:(O?V:f[ie])??V},E=O?this(Z,f,...v):this(Z,...v);E.constructor=d;let w=u({[ye]:h});if(Z[ie].push(w),C){let M=function($,W){for(let U=$;U;U=U.super)if(U.definition?.declare&&W in U.definition.declare)return!0;return!1};var N=M;if(w.declare){let $=Object.keys(w.declare).filter(W=>W in E||M(this,W));$.length&&I.log(`Declared keys '${$}' in ${d.name} already exist in base '${this.valueOf()}'`)}if(w.override){let $=Object.keys(w.override).filter(W=>!(W in E)&&!(l&&W in l)&&!M(this,W));$.length&&I.log(`Overridden keys '${$}' in ${d.name} do not exist in base '${this.valueOf()}'`)}}k(E,w.declare,!0),k(E,w.override);let S=new Set;if(w.iterable&&Object.keys(w.iterable).forEach(M=>{M in E?(I.log(`Ignoring attempt to re-define iterable property "${M}" as it could already have consumers`),S.add(M)):Ee(E,M,w.iterable[M])}),Z[ie]===V){O||L(E,f);for(let W of V){let U=W?.constructed?.call(E);ge(U)&&E.append(...A(U))}let M={},$=!1;for(let W of V)if(W.iterable)for(let U of Object.keys(W.iterable)){let Se=!O&&U in f;if(S.has(U)&&Se||!(Se&&(!X(f[U])||!Q(f[U])))){let De=E[U]?.valueOf();De!==void 0&&(M[U]=De,$=!0)}}$&&Object.assign(E,M)}return E},{super:this,definition:Object.assign(r,{[ye]:h}),extended:P,valueOf:()=>{let f=[...Object.keys(r.declare||{}),...Object.keys(r.iterable||{})];return`${d.name}: {${f.join(", ")}}
 \u21AA ${this.valueOf()}`}});Object.defineProperty(d,Symbol.hasInstance,{value:D,writable:!0,configurable:!0});let x={};(function f(v){v?.super&&f(v.super);let O=v.definition;O&&(k(x,O?.override),k(x,O?.declare))})(this),k(x,r.override),k(x,r.declare),Object.defineProperties(d,Object.getOwnPropertyDescriptors(x));let Y=x&&"className"in x&&typeof x.className=="string"?x.className:h,m=C?new Error().stack?.split(`
`)[2]??"":"";if(Object.defineProperty(d,"name",{value:"<ai-"+Y.replace(/\s+/g,"-")+m+">"}),C){let f=Object.keys(r).filter(v=>!["styles","ids","constructed","declare","override","iterable"].includes(v));f.length&&I.log(`${d.name} defines extraneous keys '${f}', which are unknown`)}return d}let F={createElement(s,u,...h){return s===F.createElement?A(...h):typeof s=="function"?s(u,h):typeof s=="string"&&s in F?F[s](u,h):s instanceof Node?s:g({error:new Error("Illegal type in createElement:"+s)})}};function j(s){if(F[s])return F[s];let u=(r,...T)=>{if(ge(r)&&(T.unshift(r),r={}),!ge(r)){if(r.debugger){debugger;delete r.debugger}let d=a?o.createElementNS(a,s.toLowerCase()):o.createElement(s);return d.constructor=u,k(d,b),L(d,r),d.append(...A(...T)),d}},h=Object.assign(u,{super:()=>{throw new Error("Can't invoke native elemenet constructors directly. Use document.createElement().")},extended:P,valueOf(){return`TagCreator: <${a||""}${a?"::":""}${s}>`}});return Object.defineProperty(u,Symbol.hasInstance,{value:D,writable:!0,configurable:!0}),Object.defineProperty(u,"name",{value:"<"+s+">"}),F[s]=h}return c.forEach(j),F};function dt(e,t,n){let a=new WeakSet;function c(y){for(let l of y)t==="addedNodes"===l.isConnected&&(c(l.childNodes),a.add(l),n&&"onRemovedFromDOM"in l&&typeof l.onRemovedFromDOM=="function"&&l.onRemovedFromDOM())}return new MutationObserver(y=>{y.forEach(function(l){l.type==="childList"&&l[t].length&&c(l[t])})}).observe(e,{subtree:!0,childList:!0}),a}return Qe(yt);})();
