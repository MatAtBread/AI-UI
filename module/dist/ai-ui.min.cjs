"use strict";var pe=Object.defineProperty;var $e=Object.getOwnPropertyDescriptor;var Fe=Object.getOwnPropertyNames;var Ge=Object.prototype.hasOwnProperty;var Se=(e,t)=>{for(var n in t)pe(e,n,{get:t[n],enumerable:!0})},Ve=(e,t,n,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Fe(t))!Ge.call(e,s)&&s!==n&&pe(e,s,{get:()=>t[s],enumerable:!(o=$e(t,s))||o.enumerable});return e};var Qe=e=>Ve(pe({},"__esModule",{value:!0}),e);var dt={};Se(dt,{Iterators:()=>Te,UniqueID:()=>ae,enableOnRemovedFromDOM:()=>Ue,getElementIdMap:()=>We,tag:()=>Le,when:()=>ce});module.exports=Qe(dt);var S=globalThis.DEBUG=="*"||globalThis.DEBUG==!0||globalThis.DEBUG?.match(/(^|\W)AI-UI(\W|$)/)||!1;var X=5e3,E={log(...e){S&&console.log("(AI-UI) LOG:",...e,new Error().stack?.replace(/Error\n\s*.*\n/,`
`))},warn(...e){S&&console.warn("(AI-UI) WARN:",...e,new Error().stack?.replace(/Error\n\s*.*\n/,`
`))},info(...e){S&&console.trace("(AI-UI) INFO:",...e)}};var Oe=e=>{};function be(){let e=Oe,t=Oe,n=new Promise((...o)=>[e,t]=o);if(n.resolve=e,n.reject=t,S){let o=new Error().stack;n.catch(s=>s instanceof Error||s?.value instanceof Error?E.log("Deferred rejection",s,"allocated at ",o):void 0)}return n}function z(e){return e&&typeof e=="object"||typeof e=="function"}function V(e){return z(e)&&"then"in e&&typeof e.then=="function"}var Te={};Se(Te,{Ignore:()=>L,Iterability:()=>_,asyncExtras:()=>ee,asyncIterator:()=>he,augmentGlobalAsyncGenerators:()=>tt,combine:()=>Ne,debounceQueueIteratableIterator:()=>Ce,defineIterableProperty:()=>Ie,filterMap:()=>Q,generatorHelpers:()=>Be,isAsyncIter:()=>F,isAsyncIterable:()=>te,isAsyncIterator:()=>J,iterableHelpers:()=>G,merge:()=>ne,queueIteratableIterator:()=>ge});var _=Symbol("Iterability");function J(e){return z(e)&&"next"in e&&typeof e?.next=="function"}function te(e){return z(e)&&Symbol.asyncIterator in e&&typeof e[Symbol.asyncIterator]=="function"}function F(e){return te(e)||J(e)}function he(e){if(J(e))return e;if(te(e))return e[Symbol.asyncIterator]();throw new Error("Not an async provider")}var ee={filterMap(e,t=L){return Q(this,e,t)},map:Ze,filter:_e,unique:Je,waitFor:ze,multi:et,initially:Xe,consume:ke,merge(...e){return ne(this,...e)},combine(e){return Ne(Object.assign({_this:this},e))}},me=[...Object.getOwnPropertySymbols(ee),...Object.keys(ee)];function le(e,t){let n=[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)];for(let o of n)Object.defineProperty(e,o,{...Object.getOwnPropertyDescriptor(t,o),enumerable:!1});return e}var k=Symbol("pending"),$=Symbol("items");function Me(e=()=>{}){let t={[k]:[],[$]:[],[Symbol.asyncIterator](){return t},next(){if(t[$]?.length)return Promise.resolve(t[$].shift());if(!t[k])return Promise.resolve({done:!0,value:void 0});let n=be();return n.catch(o=>{}),t[k].unshift(n),n},return(n){let o={done:!0,value:void 0};if(t[k]){try{e()}catch{}for(;t[k].length;)t[k].pop().resolve(o);t[$]=t[k]=null}return Promise.resolve(o)},throw(...n){let o={done:!0,value:n[0]};if(t[k]){try{e()}catch{}for(;t[k].length;)t[k].pop().reject(o);t[$]=t[k]=null}return Promise.reject(o)},get length(){return t[$]?t[$].length:-1},push(n){return t[k]?(t[k].length?t[k].pop().resolve({done:!1,value:n}):t[$]?t[$].push({done:!1,value:n}):E.log("Discarding queue push as there are no consumers"),!0):!1}};return G(t)}var ie=Symbol("inflight");function Ke(e=()=>{}){let t=Me(e);return t[ie]=new Set,t.push=function(n){if(!t[k])return!1;if(t[ie].has(n))return!0;if(t[k].length){t[ie].add(n);let o=t[k].pop();o.finally(()=>t[ie].delete(n)),o.resolve({done:!1,value:n})}else t[$]?t[$].find(o=>o.value===n)||t[$].push({done:!1,value:n}):E.log("Discarding queue push as there are no consumers");return!0},t}var ge=Me,Ce=Ke,Z=Symbol("_proxiedAsyncIterator");function Ie(e,t,n){let o=()=>{o=()=>j;let p=Ce(),O=p.multi(),j=O[Symbol.asyncIterator]();return i[Symbol.asyncIterator]=O[Symbol.asyncIterator],m=p.push,me.forEach(N=>i[N]=j[N]),Z in I||le(I,i),j};function s(p){return{[p]:function(...O){return o(),I[p].apply(this,O)}}[p]}let i={[Symbol.asyncIterator]:o};me.forEach(p=>i[p]=s(p)),typeof n=="object"&&n&&_ in n&&n[_]==="shallow"&&(i[_]=n[_]);let m=p=>(o(),m(p)),I=d(n,i),c;return Object.defineProperty(e,t,{get(){return I},set(p){if(p!==I)if(te(p)){if(c===p)return;c=p;let O=S?new Error:void 0;S&&E.info(new Error(`Iterable "${t.toString()}" has been assigned to consume another iterator. Did you mean to declare it?`)),ke.call(p,j=>{if(p!==c)throw new Error(`Piped iterable "${t.toString()}" has been replaced by another iterator`,{cause:O});m(j?.valueOf())}).catch(j=>E.info(j)).finally(()=>p===c&&(c=void 0));return}else c&&S&&E.log(`Iterable "${t.toString()}" is already piped from another iterator, and might be overrwitten later`),I=d(p,i);m(p?.valueOf())},enumerable:!0}),e;function d(p,O){if(p==null)return le(Object.create(null,{valueOf:{value(){return p},writable:!0,configurable:!0},toJSON:{value(){return p},writable:!0,configurable:!0}}),O);switch(typeof p){case"bigint":case"boolean":case"number":case"string":return le(Object(p),Object.assign(O,{toJSON(){return p.valueOf()}}));case"object":return Y(p,O)}throw new TypeError('Iterable properties cannot be of type "'+typeof p+'"')}function f(p){return z(p)&&Z in p}function v(p,O){let j=O.split(".").slice(1);for(let N=0;N<j.length&&(p=p?.[j[N]])!==void 0;N++);return p}function Y(p,O){let j,N;return new Proxy(p,se());function se(a=""){return{has(u,h){return h===Z||h===Symbol.toPrimitive||h in u||h in O},set(u,h,r,b){if(Object.hasOwn(O,h))throw new Error(`Cannot set ${t.toString()}${a}.${h.toString()} as it is part of asyncIterator`);return Reflect.get(u,h,b)!==r&&m({[Z]:{a:p,path:a}}),Reflect.set(u,h,r,b)},deleteProperty(u,h){return Reflect.deleteProperty(u,h)?(m({[Z]:{a:p,path:a}}),!0):!1},get(u,h,r){if(Object.hasOwn(O,h))return a.length?(j??(j=Q(O,l=>f(l)?l[Z]:{a:l,path:null})),Q(j,(l,x)=>{let K=v(l.a,a);return x!==K||l.path===null||l.path.startsWith(a)?K:L},L,v(p,a))[h]):(N??(N=Q(O,b=>f(b)?b[Z].a:b)),N[h]);if(h==="valueOf")return()=>v(p,a);if(h===Symbol.toPrimitive)return function(b){return Reflect.has(u,h)?Reflect.get(u,h,u).call(u,b):b==="string"?u.toString():b==="number"?Number(u):u.valueOf()};if(typeof h=="string"&&(!(h in u)||Object.hasOwn(u,h))&&!(_ in u&&u[_]==="shallow")){let b=Reflect.get(u,h,r);return typeof b=="function"||F(b)?b:new Proxy(Object(b),se(a+"."+h))}return Reflect.get(u,h,r)}}}}}var ne=(...e)=>{let t=new Array(e.length),n=new Array(e.length),o=()=>{o=()=>{};for(let c=0;c<e.length;c++){let d=e[c];n[c]=(t[c]=Symbol.asyncIterator in d?d[Symbol.asyncIterator]():d).next().then(f=>({idx:c,result:f}))}},s=[],i=new Promise(()=>{}),m=n.length,I={[Symbol.asyncIterator](){return I},next(){return o(),m?Promise.race(n).then(({idx:c,result:d})=>d.done?(m--,n[c]=i,s[c]=d.value,I.next()):(n[c]=t[c]?t[c].next().then(f=>({idx:c,result:f})).catch(f=>({idx:c,result:{done:!0,value:f}})):Promise.resolve({idx:c,result:{done:!0,value:void 0}}),d)).catch(c=>I.throw?.(c)??Promise.reject({done:!0,value:new Error("Iterator merge exception")})):Promise.resolve({done:!0,value:s})},async return(c){for(let d=0;d<t.length;d++)n[d]!==i&&(n[d]=i,s[d]=await t[d]?.return?.({done:!0,value:c}).then(f=>f.value,f=>f));return{done:!0,value:s}},async throw(c){for(let d=0;d<t.length;d++)n[d]!==i&&(n[d]=i,s[d]=await t[d]?.throw?.(c).then(f=>f.value,f=>f));return{done:!0,value:s}}};return G(I)},Ne=(e,t={})=>{let n={},o,s=[],i=0,m=new Promise(()=>{}),I={[Symbol.asyncIterator](){return I},next(){return o===void 0&&(o=Object.entries(e).map(([c,d],f)=>(i+=1,s[f]=d[Symbol.asyncIterator](),s[f].next().then(v=>({si:s,idx:f,k:c,ir:v}))))),function c(){return Promise.race(o).then(({idx:d,k:f,ir:v})=>v.done?(o[d]=m,i-=1,i?c():{done:!0,value:void 0}):(n[f]=v.value,o[d]=s[d].next().then(Y=>({idx:d,k:f,ir:Y})),t.ignorePartial&&Object.keys(n).length<Object.keys(e).length?c():{done:!1,value:n}))}()},return(c){return o.forEach((d,f)=>{d!==m&&s[f].return?.(c)}),Promise.resolve({done:!0,value:c})},throw(c){return o.forEach((d,f)=>{d!==m&&s[f].throw?.(c)}),Promise.reject({done:!0,value:c})}};return G(I)};function qe(e){return te(e)&&me.every(t=>t in e&&e[t]===ee[t])}function G(e){return qe(e)||le(e,ee),e}function Be(e){return function(...t){let n=e(...t);return G(n)}}async function ke(e){let t;for await(let n of this)t=e?.(n);await t}var L=Symbol("Ignore");function Ye(e,t,n){if(V(e))return e.then(t,n);try{return t(e)}catch(o){return n(o)}}function Q(e,t,n=L,o=L){let s,i={[Symbol.asyncIterator](){return i},next(...m){if(n!==L){let I=Promise.resolve({done:!1,value:n});return n=L,I}return new Promise(function I(c,d){s||(s=e[Symbol.asyncIterator]()),s.next(...m).then(f=>f.done?c(f):Ye(t(f.value,o),v=>v===L?I(c,d):c({done:!1,value:o=v}),v=>{s.throw?s.throw(v):s.return?.(v),d({done:!0,value:v})}),f=>d({done:!0,value:f})).catch(f=>{s.throw?s.throw(f):s.return?.(f),d({done:!0,value:f})})})},throw(m){return Promise.resolve(s?.throw?s.throw(m):s?.return?.(m)).then(I=>({done:!0,value:I?.value}))},return(m){return Promise.resolve(s?.return?.(m)).then(I=>({done:!0,value:I?.value}))}};return G(i)}function Ze(e){return Q(this,e)}function _e(e){return Q(this,async t=>await e(t)?t:L)}function Je(e){return e?Q(this,async(t,n)=>n===L||await e(t,n)?t:L):Q(this,(t,n)=>t===n?L:t)}function Xe(e){return Q(this,t=>t,e)}function ze(e){return Q(this,t=>new Promise(n=>(e(()=>n(t)),t)))}function et(){let e=this,t=0,n,o;function s(m){m&&n.resolve(m),m?.done||(n=be(),o.next().then(s).catch(I=>n.reject({done:!0,value:I})))}let i={[Symbol.asyncIterator](){return t+=1,i},next(){return o||(o=e[Symbol.asyncIterator](),s()),n},throw(m){if(t<1)throw new Error("AsyncIterator protocol error");return t-=1,t?Promise.resolve({done:!0,value:m}):Promise.resolve(o?.throw?o.throw(m):o?.return?.(m)).then(I=>({done:!0,value:I?.value}))},return(m){if(t<1)throw new Error("AsyncIterator protocol error");return t-=1,t?Promise.resolve({done:!0,value:m}):Promise.resolve(o?.return?.(m)).then(I=>({done:!0,value:I?.value}))}};return G(i)}function tt(){let e=async function*(){}();for(;e;){if(Object.getOwnPropertyDescriptor(e,Symbol.asyncIterator)){G(e);break}e=Object.getPrototypeOf(e)}e||E.warn("Failed to augment the prototype of `(async function*())()`")}var re=new Map;function nt(e){let t=re.get(e.type);if(t)for(let n of t)try{let{push:o,terminate:s,container:i,selector:m}=n;if(i.isConnected){if(e.target instanceof Node)if(m){let I=i.querySelectorAll(m);for(let c of I)(e.target===c||c.contains(e.target))&&i.contains(c)&&o(e)}else(e.target===i||i.contains(e.target))&&o(e)}else{let I="Container `#"+i.id+">"+(m||"")+"` removed from DOM. Removing subscription";t.delete(n),s(new Error(I))}}catch(o){E.warn("docEventHandler",o)}}function Ee(e){return!!(e&&(e.startsWith("#")||e.startsWith(".")||e.startsWith("[")&&e.endsWith("]")))}function Pe(e){let t=e.split(":");if(t.length===1)return Ee(t[0])?[t[0],"change"]:[null,t[0]];if(t.length===2&&Ee(t[1])&&!Ee(t[0]))return[t[1],t[0]]}function rt(e){throw new Error(e)}function ve(e,t){let[n,o]=Pe(t)??rt("Invalid WhenSelector: "+t);re.has(o)||(document.addEventListener(o,nt,{passive:!0,capture:!0}),re.set(o,new Set));let s=ge(()=>re.get(o)?.delete(i)),i={push:s.push,terminate(m){s.return?.(m)},container:e,selector:n||null};return Re(e,n?[n]:void 0).then(m=>re.get(o).add(i)),s.multi()}async function*je(){await new Promise(()=>{}),yield void 0}function xe(e){function t(n){return e.map(n)}return Object.assign(G(t),{[Symbol.asyncIterator]:()=>e[Symbol.asyncIterator]()})}function ot(e){if(!e)throw new Error(`Falsy async source will never be ready

`+JSON.stringify(e));return typeof e=="string"&&e[0]!=="@"&&!!Pe(e)}async function*at(e){yield e}function ce(e,...t){if(!t||t.length===0)return xe(ve(e,"change"));let n=t.filter(i=>typeof i!="string"||i[0]!=="@").map(i=>typeof i=="string"?ve(e,i):i instanceof Element?ve(i,"change"):V(i)?at(i):i);if(t.includes("@start")){let i={[Symbol.asyncIterator]:()=>i,next(){return i.next=()=>Promise.resolve({done:!0,value:void 0}),Promise.resolve({done:!1,value:{}})}};n.push(i)}if(t.includes("@ready")){let m=function(f){return typeof f=="string"&&!e.querySelector(f)};var s=m;let I=t.filter(ot).map(f=>Pe(f)?.[0]).filter(m),c,d={[Symbol.asyncIterator](){return d},throw(f){return c?.throw?c.throw(f):Promise.resolve({done:!0,value:f})},return(f){return c?.return?c.return(f):Promise.resolve({done:!0,value:f})},next(){return c?c.next():Re(e,I).then(()=>(c=(n.length>1?ne(...n):n.length===1?n[0]:je())[Symbol.asyncIterator](),c?{done:!1,value:{}}:{done:!0,value:void 0}))}};return xe(G(d))}let o=n.length>1?ne(...n):n.length===1?n[0]:je();return xe(G(o))}function De(e){return e.isConnected?Promise.resolve():new Promise(t=>new MutationObserver((n,o)=>{n.some(s=>s.addedNodes?.length)&&e.isConnected&&(o.disconnect(),t())}).observe(document.body,{subtree:!0,childList:!0}))}function Re(e,t){return t?.length?Promise.all([st(e,t),De(e)]):De(e)}function st(e,t){if(t=t.filter(o=>!e.querySelector(o)),!t.length)return Promise.resolve();let n=new Promise(o=>new MutationObserver((s,i)=>{s.some(m=>m.addedNodes?.length)&&t.every(m=>e.querySelector(m))&&(i.disconnect(),o())}).observe(e,{subtree:!0,childList:!0}));if(S){let o=new Error().stack?.replace(/^Error/,"Missing selectors after 5 seconds:"),s=setTimeout(()=>{E.warn(o,t)},X);n.finally(()=>clearTimeout(s))}return n}var ae=Symbol("Unique ID"),B=S?e=>`"${"innerHTML"in e?e.innerHTML:e.textContent}"`:e=>{},it=0,lt=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","menu","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","script","search","section","select","slot","small","source","span","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"],ct=Object.getOwnPropertyDescriptors({get ids(){return We(this)},set ids(e){throw new Error("Cannot set ids on "+this.valueOf())},when:function(...e){return ce(this,...e)}}),ye=document.createElement("STYLE");ye.id="--ai-ui-extended-tag-styles-";function ue(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||e instanceof Node||e instanceof NodeList||e instanceof HTMLCollection||e===null||e===void 0||Array.isArray(e)||V(e)||F(e)||typeof e=="object"&&Symbol.iterator in e&&typeof e[Symbol.iterator]=="function"}var oe=Symbol("callStack"),Le=function(e,t,n){let[o,s,i]=typeof e=="string"||e===null?[e,t,n]:Array.isArray(e)?[null,e,t]:[null,lt,e],m=ut(document,"removedNodes"),I=i?.commonProperties,c=Object.create(null,ct);Object.defineProperty(c,"attributes",{...Object.getOwnPropertyDescriptor(Element.prototype,"attributes"),set(a){if(F(a)){let u=J(a)?a:a[Symbol.asyncIterator](),h=()=>u.next().then(({done:r,value:b})=>{p(this,b),r||h()},r=>E.warn(r));h()}else p(this,a)}}),I&&v(c,I);function d(...a){let u=[];return function h(r){if(!(r==null||r===L)){if(V(r)){let b=de();u.push(b),r.then(l=>b.replaceWith(...d(l)),l=>{E.warn(l,B(b)),b.replaceWith(fe({error:l}))});return}if(r instanceof Node){u.push(r);return}if(r&&typeof r=="object"&&Symbol.iterator in r&&!(Symbol.asyncIterator in r)&&r[Symbol.iterator]){for(let b of r)h(b);return}if(F(r)){let b=S?`
`+new Error().stack?.replace(/^Error: /,"Insertion :"):"",l=J(r)?r:r[Symbol.asyncIterator](),x=r.valueOf(),K=x===void 0||x===r?[de()]:d(x),y=K.length?K:[de()];u.push(...y);let g=!0,T=Date.now()+X,P=S&&new Error("Created by").stack,U=A=>{let w=y.filter(D=>!!D?.parentNode);w.length?(y=[fe({error:A})],w[0].replaceWith(...y),w.slice(1).forEach(D=>D?.parentNode.removeChild(D))):E.warn("Can't report error",A,P,y.map(B)),y=[],l.return?.(U)},q=A=>{if(!A.done)try{let w=y.filter(C=>C?.parentNode&&C.isConnected),D=g?y:w;if(w.length&&(g=!1),!D.length||y.every(C=>m(C))){y=[];let C="Element(s) have been removed from the document: "+b;l.return?.(new Error(C));return}S&&g&&T&&T<Date.now()&&(T=Number.MAX_SAFE_INTEGER,E.warn("Async element not mounted after 5 seconds. If it is never mounted, it will leak.",P,y.map(B))),y=d(Y(A.value)),y.length||y.push(de()),D[0].replaceWith(...y),D.slice(1).forEach(C=>!y.includes(C)&&C.parentNode?.removeChild(C)),l.next().then(q).catch(U)}catch(w){y=[],l.return?.(w)}};l.next().then(q).catch(U);return}u.push(document.createTextNode(r.toString()))}}(a),u}o||Object.assign(Le,{nodes:d,UniqueID:ae});let f=Object.getPrototypeOf({});function v(a,u,h){if(!(u==null||typeof u!="object"||u===a))for(let[r,b]of Object.entries(Object.getOwnPropertyDescriptors(u)))try{if("value"in b){let l=b.value;l&&F(l)?Object.defineProperty(a,r,b):l&&typeof l=="object"&&!V(l)?r in a?l instanceof Node?(E.info("Having DOM Nodes as properties of other DOM Nodes is a bad idea as it makes the DOM tree into a cyclic graph. You should reference nodes by ID or as a child",r,B(l)),a[r]=l):a[r]!==l&&(Array.isArray(a[r])&&a[r].length!==l.length?l.constructor===Object||l.constructor===Array?v(a[r]=new l.constructor,l):a[r]=l:v(a[r],l)):(h&&(Object.getPrototypeOf(l)===f||!Object.getPrototypeOf(l)?v(b.value={},l):Array.isArray(l)?v(b.value=[],l):E.warn(`Declared propety '${r}' is not a plain object and must be assigned by reference, possibly polluting other instances of this tag`,a,l)),Object.defineProperty(a,r,b)):u[r]!==void 0&&(a[r]=u[r])}else Object.defineProperty(a,r,b)}catch(l){throw E.warn("deepAssign",r,u[r],l),l}}function Y(a){let u=a?.valueOf();return Array.isArray(u)?Array.prototype.map.call(u,Y):u}function p(a,u){oe in u||function h(r,b){if(b==null||typeof b!="object")return;let l=Object.entries(Object.getOwnPropertyDescriptors(b));Array.isArray(b)||l.sort((y,g)=>{let T=Object.getOwnPropertyDescriptor(r,y[0]);if(T){if("value"in T)return-1;if("set"in T)return 1;if("get"in T)return .5}return 0});for(let[y,g]of l)try{if("value"in g){let T=g.value;F(T)?x(T,y):V(T)?T.then(P=>{P&&typeof P=="object"?F(P)?x(P,y):K(P,y):b[y]!==void 0&&(r[y]=P)},P=>E.log("Failed to set attribute",P)):F(T)||(T&&typeof T=="object"&&!V(T)?K(T,y):b[y]!==void 0&&(r[y]=b[y]))}else Object.defineProperty(r,y,g)}catch(T){throw E.warn("assignProps",y,b[y],T),T}function x(y,g){let T=he(y),P=!0,U=Date.now()+X,q=S&&new Error("Created by").stack,A=C=>{if(!C.done){let M=Y(C.value);if(typeof M=="object"&&M!==null){let R=Object.getOwnPropertyDescriptor(r,g);g==="style"||!R?.set?h(r[g],M):r[g]=M}else M!==void 0&&(r[g]=M);let W=a.isConnected;if(m(a)||!P&&!W){E.info(`Element does not exist in document when setting async attribute '${g}' to:
${B(a)}`),T.return?.();return}W&&(P=!1),P&&U&&U<Date.now()&&(U=Number.MAX_SAFE_INTEGER,E.warn(`Element with async attribute '${g}' not mounted after 5 seconds. If it is never mounted, it will leak.
Element contains: ${B(a)}
${q}`)),T.next().then(A).catch(w)}},w=C=>{E.warn("Dynamic attribute error",C,g,r,q,B(a)),T.return?.(C),a.appendChild(fe({error:C}))},D=y.valueOf();D!==void 0&&D!==y&&!F(D)?A({done:!1,value:D}):T.next().then(A).catch(w)}function K(y,g){if(y instanceof Node)E.info("Having DOM Nodes as properties of other DOM Nodes is a bad idea as it makes the DOM tree into a cyclic graph. You should reference nodes by ID or via a collection such as .childNodes",g,B(y)),r[g]=y;else if(!(g in r)||r[g]===y||Array.isArray(r[g])&&r[g].length!==y.length)if(y.constructor===Object||y.constructor===Array){let T=new y.constructor;h(T,y),r[g]=T}else r[g]=y;else Object.getOwnPropertyDescriptor(r,g)?.set?r[g]=y:h(r[g],y)}}(a,u)}function O(a){for(let u=a.constructor;u;u=u.super)if(u===this)return!0;return!1}function j(a){let u=typeof a!="function"?g=>Object.assign({},a,g):a,h=Date.now().toString(36)+(it++).toString(36)+Math.random().toString(36).slice(2),r=u({[ae]:h});r.styles&&(ye.appendChild(document.createTextNode(r.styles+`
`)),document.head.contains(ye)||document.head.appendChild(ye));let l=Object.assign((g,...T)=>{let P=ue(g),U=[],q={[oe]:(P?U:g[oe])??U},A=P?this(q,g,...T):this(q,...T);A.constructor=l;let w=u({[ae]:h});if(q[oe].push(w),S){let M=function(W,R){for(let H=W;H;H=H.super)if(H.definition?.declare&&R in H.definition.declare)return!0;return!1};var C=M;if(w.declare){let W=Object.keys(w.declare).filter(R=>R in A||M(this,R));W.length&&E.log(`Declared keys '${W}' in ${l.name} already exist in base '${this.valueOf()}'`)}if(w.override){let W=Object.keys(w.override).filter(R=>!(R in A)&&!(I&&R in I)&&!M(this,R));W.length&&E.log(`Overridden keys '${W}' in ${l.name} do not exist in base '${this.valueOf()}'`)}}v(A,w.declare,!0),v(A,w.override);let D=new Set;if(w.iterable&&Object.keys(w.iterable).forEach(M=>{M in A?(E.log(`Ignoring attempt to re-define iterable property "${M}" as it could already have consumers`),D.add(M)):Ie(A,M,w.iterable[M])}),q[oe]===U){P||p(A,g);for(let R of U){let H=R?.constructed?.call(A);ue(H)&&A.append(...d(H))}let M={},W=!1;for(let R of U)if(R.iterable)for(let H of Object.keys(R.iterable)){let Ae=!P&&H in g;if(D.has(H)&&Ae||!(Ae&&(!V(g[H])||!F(g[H])))){let we=A[H]?.valueOf();we!==void 0&&(M[H]=we,W=!0)}}W&&Object.assign(A,M)}return A},{super:this,definition:Object.assign(r,{[ae]:h}),extended:j,valueOf:()=>{let g=[...Object.keys(r.declare||{}),...Object.keys(r.iterable||{})];return`${l.name}: {${g.join(", ")}}
 \u21AA ${this.valueOf()}`}});Object.defineProperty(l,Symbol.hasInstance,{value:O,writable:!0,configurable:!0});let x={};(function g(T){T?.super&&g(T.super);let P=T.definition;P&&(v(x,P?.override),v(x,P?.declare))})(this),v(x,r.override),v(x,r.declare),Object.defineProperties(l,Object.getOwnPropertyDescriptors(x));let K=x&&"className"in x&&typeof x.className=="string"?x.className:h,y=S?new Error().stack?.split(`
`)[2]??"":"";if(Object.defineProperty(l,"name",{value:"<ai-"+K.replace(/\s+/g,"-")+y+">"}),S){let g=Object.keys(r).filter(T=>!["styles","ids","constructed","declare","override","iterable"].includes(T));g.length&&E.log(`${l.name} defines extraneous keys '${g}', which are unknown`)}return l}let N={createElement(a,u,...h){return a===N.createElement?d(...h):typeof a=="function"?a(u,h):typeof a=="string"&&a in N?N[a](u,h):a instanceof Node?a:fe({error:new Error("Illegal type in createElement:"+a)})}};function se(a){if(N[a])return N[a];let u=(r,...b)=>{let l=document;if(ue(r)&&(b.unshift(r),r={}),!ue(r)){if(r.debugger){debugger;delete r.debugger}r.document&&(l=r.document,delete r.document);let x=o?l.createElementNS(o,a.toLowerCase()):l.createElement(a);return x.constructor=u,v(x,c),p(x,r),x.append(...d(...b)),x}},h=Object.assign(u,{super:()=>{throw new Error("Can't invoke native elemenet constructors directly. Use document.createElement().")},extended:j,valueOf(){return`TagCreator: <${o||""}${o?"::":""}${a}>`}});return Object.defineProperty(u,Symbol.hasInstance,{value:O,writable:!0,configurable:!0}),Object.defineProperty(u,"name",{value:"<"+a+">"}),N[a]=h}return s.forEach(se),N};function de(){return document.createComment(S&&new Error("promise").stack?.replace(/^Error: /,"")||"promise")}function fe({error:e}){return document.createComment(e instanceof Error?e.toString():`Error:
`+JSON.stringify(e,null,2))}var Ue=function(){Ue=function(){},new MutationObserver(e=>{e.forEach(function(t){t.type==="childList"&&t.removedNodes.forEach(n=>n&&n instanceof Element&&[...n.getElementsByTagName("*"),n].filter(o=>!o.isConnected).forEach(o=>{"onRemovedFromDOM"in o&&typeof o.onRemovedFromDOM=="function"&&o.onRemovedFromDOM()}))})}).observe(document.body,{subtree:!0,childList:!0})};function ut(e,t){let n=new WeakSet;function o(s){for(let i of s)t==="addedNodes"===i.isConnected&&(o(i.childNodes),n.add(i))}return new MutationObserver(s=>{s.forEach(function(i){i.type==="childList"&&i.removedNodes.length&&o(i[t])})}).observe(e,{subtree:!0,childList:!0}),function(s){return n.has(s)}}var He=new Set;function We(e,t){return e=e||document,t=t||Object.create(null),e.querySelectorAll&&e.querySelectorAll("[id]").forEach(function(n){n.id&&(t[n.id]?S&&(He.has(n.id)||(He.add(n.id),E.info("Shadowed multiple element IDs",n.id))):t[n.id]=n)}),t}
