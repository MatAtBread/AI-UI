var Re=Object.defineProperty;var He=(e,t)=>{for(var n in t)Re(e,n,{get:t[n],enumerable:!0})};var S=globalThis.DEBUG=="*"||globalThis.DEBUG==!0||globalThis.DEBUG?.match(/(^|\W)AI-UI(\W|$)/)||!1;var X=5e3,E={log(...e){S&&console.log("(AI-UI) LOG:",...e,new Error().stack?.replace(/Error\n\s*.*\n/,`
`))},warn(...e){S&&console.warn("(AI-UI) WARN:",...e,new Error().stack?.replace(/Error\n\s*.*\n/,`
`))},info(...e){S&&console.trace("(AI-UI) INFO:",...e)}};var Ae=e=>{};function ye(){let e=Ae,t=Ae,n=new Promise((...o)=>[e,t]=o);if(n.resolve=e,n.reject=t,S){let o=new Error().stack;n.catch(u=>u instanceof Error||u?.value instanceof Error?E.log("Deferred rejection",u,"allocated at ",o):void 0)}return n}function z(e){return e&&typeof e=="object"||typeof e=="function"}function V(e){return z(e)&&"then"in e&&typeof e.then=="function"}var Ce={};He(Ce,{Ignore:()=>L,Iterability:()=>_,asyncExtras:()=>ee,asyncIterator:()=>be,augmentGlobalAsyncGenerators:()=>Be,combine:()=>Oe,debounceQueueIteratableIterator:()=>Se,defineIterableProperty:()=>he,filterMap:()=>Q,generatorHelpers:()=>We,isAsyncIter:()=>F,isAsyncIterable:()=>te,isAsyncIterator:()=>J,iterableHelpers:()=>G,merge:()=>ne,queueIteratableIterator:()=>me});var _=Symbol("Iterability");function J(e){return z(e)&&"next"in e&&typeof e?.next=="function"}function te(e){return z(e)&&Symbol.asyncIterator in e&&typeof e[Symbol.asyncIterator]=="function"}function F(e){return te(e)||J(e)}function be(e){if(J(e))return e;if(te(e))return e[Symbol.asyncIterator]();throw new Error("Not an async provider")}var ee={filterMap(e,t=L){return Q(this,e,t)},map:Fe,filter:Ge,unique:Ve,waitFor:Ke,multi:qe,initially:Qe,consume:Me,merge(...e){return ne(this,...e)},combine(e){return Oe(Object.assign({_this:this},e))}},pe=[...Object.getOwnPropertySymbols(ee),...Object.keys(ee)];function ie(e,t){let n=[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)];for(let o of n)Object.defineProperty(e,o,{...Object.getOwnPropertyDescriptor(t,o),enumerable:!1});return e}var k=Symbol("pending"),$=Symbol("items");function we(e=()=>{}){let t={[k]:[],[$]:[],[Symbol.asyncIterator](){return t},next(){if(t[$]?.length)return Promise.resolve(t[$].shift());if(!t[k])return Promise.resolve({done:!0,value:void 0});let n=ye();return n.catch(o=>{}),t[k].unshift(n),n},return(n){let o={done:!0,value:void 0};if(t[k]){try{e()}catch{}for(;t[k].length;)t[k].pop().resolve(o);t[$]=t[k]=null}return Promise.resolve(o)},throw(...n){let o={done:!0,value:n[0]};if(t[k]){try{e()}catch{}for(;t[k].length;)t[k].pop().reject(o);t[$]=t[k]=null}return Promise.reject(o)},get length(){return t[$]?t[$].length:-1},push(n){return t[k]?(t[k].length?t[k].pop().resolve({done:!1,value:n}):t[$]?t[$].push({done:!1,value:n}):E.log("Discarding queue push as there are no consumers"),!0):!1}};return G(t)}var se=Symbol("inflight");function Le(e=()=>{}){let t=we(e);return t[se]=new Set,t.push=function(n){if(!t[k])return!1;if(t[se].has(n))return!0;if(t[k].length){t[se].add(n);let o=t[k].pop();o.finally(()=>t[se].delete(n)),o.resolve({done:!1,value:n})}else t[$]?t[$].find(o=>o.value===n)||t[$].push({done:!1,value:n}):E.log("Discarding queue push as there are no consumers");return!0},t}var me=we,Se=Le,Z=Symbol("_proxiedAsyncIterator");function he(e,t,n){let o=()=>{o=()=>j;let p=Se(),O=p.multi(),j=O[Symbol.asyncIterator]();return s[Symbol.asyncIterator]=O[Symbol.asyncIterator],m=p.push,pe.forEach(N=>s[N]=j[N]),Z in I||ie(I,s),j};function u(p){return{[p]:function(...O){return o(),I[p].apply(this,O)}}[p]}let s={[Symbol.asyncIterator]:o};pe.forEach(p=>s[p]=u(p)),typeof n=="object"&&n&&_ in n&&n[_]==="shallow"&&(s[_]=n[_]);let m=p=>(o(),m(p)),I=d(n,s),l;return Object.defineProperty(e,t,{get(){return I},set(p){if(p!==I)if(te(p)){if(l===p)return;l=p;let O=S?new Error:void 0;S&&E.info(new Error(`Iterable "${t.toString()}" has been assigned to consume another iterator. Did you mean to declare it?`)),Me.call(p,j=>{if(p!==l)throw new Error(`Piped iterable "${t.toString()}" has been replaced by another iterator`,{cause:O});m(j?.valueOf())}).catch(j=>E.info(j)).finally(()=>p===l&&(l=void 0));return}else l&&S&&E.log(`Iterable "${t.toString()}" is already piped from another iterator, and might be overrwitten later`),I=d(p,s);m(p?.valueOf())},enumerable:!0}),e;function d(p,O){if(p==null)return ie(Object.create(null,{valueOf:{value(){return p},writable:!0,configurable:!0},toJSON:{value(){return p},writable:!0,configurable:!0}}),O);switch(typeof p){case"bigint":case"boolean":case"number":case"string":return ie(Object(p),Object.assign(O,{toJSON(){return p.valueOf()}}));case"object":return Y(p,O)}throw new TypeError('Iterable properties cannot be of type "'+typeof p+'"')}function f(p){return z(p)&&Z in p}function v(p,O){let j=O.split(".").slice(1);for(let N=0;N<j.length&&(p=p?.[j[N]])!==void 0;N++);return p}function Y(p,O){let j,N;return new Proxy(p,ae());function ae(a=""){return{has(c,h){return h===Z||h===Symbol.toPrimitive||h in c||h in O},set(c,h,r,b){if(Object.hasOwn(O,h))throw new Error(`Cannot set ${t.toString()}${a}.${h.toString()} as it is part of asyncIterator`);return Reflect.get(c,h,b)!==r&&m({[Z]:{a:p,path:a}}),Reflect.set(c,h,r,b)},deleteProperty(c,h){return Reflect.deleteProperty(c,h)?(m({[Z]:{a:p,path:a}}),!0):!1},get(c,h,r){if(Object.hasOwn(O,h))return a.length?(j??(j=Q(O,i=>f(i)?i[Z]:{a:i,path:null})),Q(j,(i,x)=>{let K=v(i.a,a);return x!==K||i.path===null||i.path.startsWith(a)?K:L},L,v(p,a))[h]):(N??(N=Q(O,b=>f(b)?b[Z].a:b)),N[h]);if(h==="valueOf")return()=>v(p,a);if(h===Symbol.toPrimitive)return function(b){return Reflect.has(c,h)?Reflect.get(c,h,c).call(c,b):b==="string"?c.toString():b==="number"?Number(c):c.valueOf()};if(typeof h=="string"&&(!(h in c)||Object.hasOwn(c,h))&&!(_ in c&&c[_]==="shallow")){let b=Reflect.get(c,h,r);return typeof b=="function"||F(b)?b:new Proxy(Object(b),ae(a+"."+h))}return Reflect.get(c,h,r)}}}}}var ne=(...e)=>{let t=new Array(e.length),n=new Array(e.length),o=()=>{o=()=>{};for(let l=0;l<e.length;l++){let d=e[l];n[l]=(t[l]=Symbol.asyncIterator in d?d[Symbol.asyncIterator]():d).next().then(f=>({idx:l,result:f}))}},u=[],s=new Promise(()=>{}),m=n.length,I={[Symbol.asyncIterator](){return I},next(){return o(),m?Promise.race(n).then(({idx:l,result:d})=>d.done?(m--,n[l]=s,u[l]=d.value,I.next()):(n[l]=t[l]?t[l].next().then(f=>({idx:l,result:f})).catch(f=>({idx:l,result:{done:!0,value:f}})):Promise.resolve({idx:l,result:{done:!0,value:void 0}}),d)).catch(l=>I.throw?.(l)??Promise.reject({done:!0,value:new Error("Iterator merge exception")})):Promise.resolve({done:!0,value:u})},async return(l){for(let d=0;d<t.length;d++)n[d]!==s&&(n[d]=s,u[d]=await t[d]?.return?.({done:!0,value:l}).then(f=>f.value,f=>f));return{done:!0,value:u}},async throw(l){for(let d=0;d<t.length;d++)n[d]!==s&&(n[d]=s,u[d]=await t[d]?.throw?.(l).then(f=>f.value,f=>f));return{done:!0,value:u}}};return G(I)},Oe=(e,t={})=>{let n={},o,u=[],s=0,m=new Promise(()=>{}),I={[Symbol.asyncIterator](){return I},next(){return o===void 0&&(o=Object.entries(e).map(([l,d],f)=>(s+=1,u[f]=d[Symbol.asyncIterator](),u[f].next().then(v=>({si:u,idx:f,k:l,ir:v}))))),function l(){return Promise.race(o).then(({idx:d,k:f,ir:v})=>v.done?(o[d]=m,s-=1,s?l():{done:!0,value:void 0}):(n[f]=v.value,o[d]=u[d].next().then(Y=>({idx:d,k:f,ir:Y})),t.ignorePartial&&Object.keys(n).length<Object.keys(e).length?l():{done:!1,value:n}))}()},return(l){return o.forEach((d,f)=>{d!==m&&u[f].return?.(l)}),Promise.resolve({done:!0,value:l})},throw(l){return o.forEach((d,f)=>{d!==m&&u[f].throw?.(l)}),Promise.reject({done:!0,value:l})}};return G(I)};function Ue(e){return te(e)&&pe.every(t=>t in e&&e[t]===ee[t])}function G(e){return Ue(e)||ie(e,ee),e}function We(e){return function(...t){let n=e(...t);return G(n)}}async function Me(e){let t;for await(let n of this)t=e?.(n);await t}var L=Symbol("Ignore");function $e(e,t,n){if(V(e))return e.then(t,n);try{return t(e)}catch(o){return n(o)}}function Q(e,t,n=L,o=L){let u,s={[Symbol.asyncIterator](){return s},next(...m){if(n!==L){let I=Promise.resolve({done:!1,value:n});return n=L,I}return new Promise(function I(l,d){u||(u=e[Symbol.asyncIterator]()),u.next(...m).then(f=>f.done?l(f):$e(t(f.value,o),v=>v===L?I(l,d):l({done:!1,value:o=v}),v=>{u.throw?u.throw(v):u.return?.(v),d({done:!0,value:v})}),f=>d({done:!0,value:f})).catch(f=>{u.throw?u.throw(f):u.return?.(f),d({done:!0,value:f})})})},throw(m){return Promise.resolve(u?.throw?u.throw(m):u?.return?.(m)).then(I=>({done:!0,value:I?.value}))},return(m){return Promise.resolve(u?.return?.(m)).then(I=>({done:!0,value:I?.value}))}};return G(s)}function Fe(e){return Q(this,e)}function Ge(e){return Q(this,async t=>await e(t)?t:L)}function Ve(e){return e?Q(this,async(t,n)=>n===L||await e(t,n)?t:L):Q(this,(t,n)=>t===n?L:t)}function Qe(e){return Q(this,t=>t,e)}function Ke(e){return Q(this,t=>new Promise(n=>(e(()=>n(t)),t)))}function qe(){let e=this,t=0,n,o;function u(m){m&&n.resolve(m),m?.done||(n=ye(),o.next().then(u).catch(I=>n.reject({done:!0,value:I})))}let s={[Symbol.asyncIterator](){return t+=1,s},next(){return o||(o=e[Symbol.asyncIterator](),u()),n},throw(m){if(t<1)throw new Error("AsyncIterator protocol error");return t-=1,t?Promise.resolve({done:!0,value:m}):Promise.resolve(o?.throw?o.throw(m):o?.return?.(m)).then(I=>({done:!0,value:I?.value}))},return(m){if(t<1)throw new Error("AsyncIterator protocol error");return t-=1,t?Promise.resolve({done:!0,value:m}):Promise.resolve(o?.return?.(m)).then(I=>({done:!0,value:I?.value}))}};return G(s)}function Be(){let e=async function*(){}();for(;e;){if(Object.getOwnPropertyDescriptor(e,Symbol.asyncIterator)){G(e);break}e=Object.getPrototypeOf(e)}e||E.warn("Failed to augment the prototype of `(async function*())()`")}var re=new Map;function Ye(e){let t=re.get(e.type);if(t)for(let n of t)try{let{push:o,terminate:u,container:s,selector:m}=n;if(s.isConnected){if(e.target instanceof Node)if(m){let I=s.querySelectorAll(m);for(let l of I)(e.target===l||l.contains(e.target))&&s.contains(l)&&o(e)}else(e.target===s||s.contains(e.target))&&o(e)}else{let I="Container `#"+s.id+">"+(m||"")+"` removed from DOM. Removing subscription";t.delete(n),u(new Error(I))}}catch(o){E.warn("docEventHandler",o)}}function ge(e){return!!(e&&(e.startsWith("#")||e.startsWith(".")||e.startsWith("[")&&e.endsWith("]")))}function Ee(e){let t=e.split(":");if(t.length===1)return ge(t[0])?[t[0],"change"]:[null,t[0]];if(t.length===2&&ge(t[1])&&!ge(t[0]))return[t[1],t[0]]}function Ze(e){throw new Error(e)}function Ie(e,t){let[n,o]=Ee(t)??Ze("Invalid WhenSelector: "+t);re.has(o)||(document.addEventListener(o,Ye,{passive:!0,capture:!0}),re.set(o,new Set));let u=me(()=>re.get(o)?.delete(s)),s={push:u.push,terminate(m){u.return?.(m)},container:e,selector:n||null};return je(e,n?[n]:void 0).then(m=>re.get(o).add(s)),u.multi()}async function*Ne(){await new Promise(()=>{}),yield void 0}function Te(e){function t(n){return e.map(n)}return Object.assign(G(t),{[Symbol.asyncIterator]:()=>e[Symbol.asyncIterator]()})}function _e(e){if(!e)throw new Error(`Falsy async source will never be ready

`+JSON.stringify(e));return typeof e=="string"&&e[0]!=="@"&&!!Ee(e)}async function*Je(e){yield e}function ve(e,...t){if(!t||t.length===0)return Te(Ie(e,"change"));let n=t.filter(s=>typeof s!="string"||s[0]!=="@").map(s=>typeof s=="string"?Ie(e,s):s instanceof Element?Ie(s,"change"):V(s)?Je(s):s);if(t.includes("@start")){let s={[Symbol.asyncIterator]:()=>s,next(){return s.next=()=>Promise.resolve({done:!0,value:void 0}),Promise.resolve({done:!1,value:{}})}};n.push(s)}if(t.includes("@ready")){let m=function(f){return typeof f=="string"&&!e.querySelector(f)};var u=m;let I=t.filter(_e).map(f=>Ee(f)?.[0]).filter(m),l,d={[Symbol.asyncIterator](){return d},throw(f){return l?.throw?l.throw(f):Promise.resolve({done:!0,value:f})},return(f){return l?.return?l.return(f):Promise.resolve({done:!0,value:f})},next(){return l?l.next():je(e,I).then(()=>(l=(n.length>1?ne(...n):n.length===1?n[0]:Ne())[Symbol.asyncIterator](),l?{done:!1,value:{}}:{done:!0,value:void 0}))}};return Te(G(d))}let o=n.length>1?ne(...n):n.length===1?n[0]:Ne();return Te(G(o))}function ke(e){return e.isConnected?Promise.resolve():new Promise(t=>new MutationObserver((n,o)=>{n.some(u=>u.addedNodes?.length)&&e.isConnected&&(o.disconnect(),t())}).observe(document.body,{subtree:!0,childList:!0}))}function je(e,t){return t?.length?Promise.all([Xe(e,t),ke(e)]):ke(e)}function Xe(e,t){if(t=t.filter(o=>!e.querySelector(o)),!t.length)return Promise.resolve();let n=new Promise(o=>new MutationObserver((u,s)=>{u.some(m=>m.addedNodes?.length)&&t.every(m=>e.querySelector(m))&&(s.disconnect(),o())}).observe(e,{subtree:!0,childList:!0}));if(S){let o=new Error().stack?.replace(/^Error/,"Missing selectors after 5 seconds:"),u=setTimeout(()=>{E.warn(o,t)},X);n.finally(()=>clearTimeout(u))}return n}var le=Symbol("Unique ID"),B=S?e=>`"${"innerHTML"in e?e.innerHTML:e.textContent}"`:e=>{},ze=0,et=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","menu","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","script","search","section","select","slot","small","source","span","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"],tt=Object.getOwnPropertyDescriptors({get ids(){return at(this)},set ids(e){throw new Error("Cannot set ids on "+this.valueOf())},when:function(...e){return ve(this,...e)}}),fe=document.createElement("STYLE");fe.id="--ai-ui-extended-tag-styles-";function ce(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||e instanceof Node||e instanceof NodeList||e instanceof HTMLCollection||e===null||e===void 0||Array.isArray(e)||V(e)||F(e)||typeof e=="object"&&Symbol.iterator in e&&typeof e[Symbol.iterator]=="function"}var oe=Symbol("callStack"),nt=function(e,t,n){let[o,u,s]=typeof e=="string"||e===null?[e,t,n]:Array.isArray(e)?[null,e,t]:[null,et,e],m=ot(document,"removedNodes"),I=s?.commonProperties,l=Object.create(null,tt);Object.defineProperty(l,"attributes",{...Object.getOwnPropertyDescriptor(Element.prototype,"attributes"),set(a){if(F(a)){let c=J(a)?a:a[Symbol.asyncIterator](),h=()=>c.next().then(({done:r,value:b})=>{p(this,b),r||h()},r=>E.warn(r));h()}else p(this,a)}}),I&&v(l,I);function d(...a){let c=[];return function h(r){if(!(r==null||r===L)){if(V(r)){let b=ue();c.push(b),r.then(i=>b.replaceWith(...d(i)),i=>{E.warn(i,B(b)),b.replaceWith(de({error:i}))});return}if(r instanceof Node){c.push(r);return}if(r&&typeof r=="object"&&Symbol.iterator in r&&!(Symbol.asyncIterator in r)&&r[Symbol.iterator]){for(let b of r)h(b);return}if(F(r)){let b=S?`
`+new Error().stack?.replace(/^Error: /,"Insertion :"):"",i=J(r)?r:r[Symbol.asyncIterator](),x=r.valueOf(),K=x===void 0||x===r?[ue()]:d(x),y=K.length?K:[ue()];c.push(...y);let g=!0,T=Date.now()+X,P=S&&new Error("Created by").stack,U=A=>{let w=y.filter(D=>!!D?.parentNode);w.length?(y=[de({error:A})],w[0].replaceWith(...y),w.slice(1).forEach(D=>D?.parentNode.removeChild(D))):E.warn("Can't report error",A,P,y.map(B)),y=[],i.return?.(U)},q=A=>{if(!A.done)try{let w=y.filter(C=>C?.parentNode&&C.isConnected),D=g?y:w;if(w.length&&(g=!1),!D.length||y.every(C=>m(C))){y=[];let C="Element(s) have been removed from the document: "+b;i.return?.(new Error(C));return}S&&g&&T&&T<Date.now()&&(T=Number.MAX_SAFE_INTEGER,E.warn("Async element not mounted after 5 seconds. If it is never mounted, it will leak.",P,y.map(B))),y=d(Y(A.value)),y.length||y.push(ue()),D[0].replaceWith(...y),D.slice(1).forEach(C=>!y.includes(C)&&C.parentNode?.removeChild(C)),i.next().then(q).catch(U)}catch(w){y=[],i.return?.(w)}};i.next().then(q).catch(U);return}c.push(document.createTextNode(r.toString()))}}(a),c}o||Object.assign(nt,{nodes:d,UniqueID:le});let f=Object.getPrototypeOf({});function v(a,c,h){if(!(c==null||typeof c!="object"||c===a))for(let[r,b]of Object.entries(Object.getOwnPropertyDescriptors(c)))try{if("value"in b){let i=b.value;i&&F(i)?Object.defineProperty(a,r,b):i&&typeof i=="object"&&!V(i)?r in a?i instanceof Node?(E.info("Having DOM Nodes as properties of other DOM Nodes is a bad idea as it makes the DOM tree into a cyclic graph. You should reference nodes by ID or as a child",r,B(i)),a[r]=i):a[r]!==i&&(Array.isArray(a[r])&&a[r].length!==i.length?i.constructor===Object||i.constructor===Array?v(a[r]=new i.constructor,i):a[r]=i:v(a[r],i)):(h&&(Object.getPrototypeOf(i)===f||!Object.getPrototypeOf(i)?v(b.value={},i):Array.isArray(i)?v(b.value=[],i):E.warn(`Declared propety '${r}' is not a plain object and must be assigned by reference, possibly polluting other instances of this tag`,a,i)),Object.defineProperty(a,r,b)):c[r]!==void 0&&(a[r]=c[r])}else Object.defineProperty(a,r,b)}catch(i){throw E.warn("deepAssign",r,c[r],i),i}}function Y(a){let c=a?.valueOf();return Array.isArray(c)?Array.prototype.map.call(c,Y):c}function p(a,c){oe in c||function h(r,b){if(b==null||typeof b!="object")return;let i=Object.entries(Object.getOwnPropertyDescriptors(b));Array.isArray(b)||i.sort((y,g)=>{let T=Object.getOwnPropertyDescriptor(r,y[0]);if(T){if("value"in T)return-1;if("set"in T)return 1;if("get"in T)return .5}return 0});for(let[y,g]of i)try{if("value"in g){let T=g.value;F(T)?x(T,y):V(T)?T.then(P=>{P&&typeof P=="object"?F(P)?x(P,y):K(P,y):b[y]!==void 0&&(r[y]=P)},P=>E.log("Failed to set attribute",P)):F(T)||(T&&typeof T=="object"&&!V(T)?K(T,y):b[y]!==void 0&&(r[y]=b[y]))}else Object.defineProperty(r,y,g)}catch(T){throw E.warn("assignProps",y,b[y],T),T}function x(y,g){let T=be(y),P=!0,U=Date.now()+X,q=S&&new Error("Created by").stack,A=C=>{if(!C.done){let M=Y(C.value);if(typeof M=="object"&&M!==null){let R=Object.getOwnPropertyDescriptor(r,g);g==="style"||!R?.set?h(r[g],M):r[g]=M}else M!==void 0&&(r[g]=M);let W=a.isConnected;if(m(a)||!P&&!W){E.info(`Element does not exist in document when setting async attribute '${g}' to:
${B(a)}`),T.return?.();return}W&&(P=!1),P&&U&&U<Date.now()&&(U=Number.MAX_SAFE_INTEGER,E.warn(`Element with async attribute '${g}' not mounted after 5 seconds. If it is never mounted, it will leak.
Element contains: ${B(a)}
${q}`)),T.next().then(A).catch(w)}},w=C=>{E.warn("Dynamic attribute error",C,g,r,q,B(a)),T.return?.(C),a.appendChild(de({error:C}))},D=y.valueOf();D!==void 0&&D!==y&&!F(D)?A({done:!1,value:D}):T.next().then(A).catch(w)}function K(y,g){if(y instanceof Node)E.info("Having DOM Nodes as properties of other DOM Nodes is a bad idea as it makes the DOM tree into a cyclic graph. You should reference nodes by ID or via a collection such as .childNodes",g,B(y)),r[g]=y;else if(!(g in r)||r[g]===y||Array.isArray(r[g])&&r[g].length!==y.length)if(y.constructor===Object||y.constructor===Array){let T=new y.constructor;h(T,y),r[g]=T}else r[g]=y;else Object.getOwnPropertyDescriptor(r,g)?.set?r[g]=y:h(r[g],y)}}(a,c)}function O(a){for(let c=a.constructor;c;c=c.super)if(c===this)return!0;return!1}function j(a){let c=typeof a!="function"?g=>Object.assign({},a,g):a,h=Date.now().toString(36)+(ze++).toString(36)+Math.random().toString(36).slice(2),r=c({[le]:h});r.styles&&(fe.appendChild(document.createTextNode(r.styles+`
`)),document.head.contains(fe)||document.head.appendChild(fe));let i=Object.assign((g,...T)=>{let P=ce(g),U=[],q={[oe]:(P?U:g[oe])??U},A=P?this(q,g,...T):this(q,...T);A.constructor=i;let w=c({[le]:h});if(q[oe].push(w),S){let M=function(W,R){for(let H=W;H;H=H.super)if(H.definition?.declare&&R in H.definition.declare)return!0;return!1};var C=M;if(w.declare){let W=Object.keys(w.declare).filter(R=>R in A||M(this,R));W.length&&E.log(`Declared keys '${W}' in ${i.name} already exist in base '${this.valueOf()}'`)}if(w.override){let W=Object.keys(w.override).filter(R=>!(R in A)&&!(I&&R in I)&&!M(this,R));W.length&&E.log(`Overridden keys '${W}' in ${i.name} do not exist in base '${this.valueOf()}'`)}}v(A,w.declare,!0),v(A,w.override);let D=new Set;if(w.iterable&&Object.keys(w.iterable).forEach(M=>{M in A?(E.log(`Ignoring attempt to re-define iterable property "${M}" as it could already have consumers`),D.add(M)):he(A,M,w.iterable[M])}),q[oe]===U){P||p(A,g);for(let R of U){let H=R?.constructed?.call(A);ce(H)&&A.append(...d(H))}let M={},W=!1;for(let R of U)if(R.iterable)for(let H of Object.keys(R.iterable)){let xe=!P&&H in g;if(D.has(H)&&xe||!(xe&&(!V(g[H])||!F(g[H])))){let Pe=A[H]?.valueOf();Pe!==void 0&&(M[H]=Pe,W=!0)}}W&&Object.assign(A,M)}return A},{super:this,definition:Object.assign(r,{[le]:h}),extended:j,valueOf:()=>{let g=[...Object.keys(r.declare||{}),...Object.keys(r.iterable||{})];return`${i.name}: {${g.join(", ")}}
 \u21AA ${this.valueOf()}`}});Object.defineProperty(i,Symbol.hasInstance,{value:O,writable:!0,configurable:!0});let x={};(function g(T){T?.super&&g(T.super);let P=T.definition;P&&(v(x,P?.override),v(x,P?.declare))})(this),v(x,r.override),v(x,r.declare),Object.defineProperties(i,Object.getOwnPropertyDescriptors(x));let K=x&&"className"in x&&typeof x.className=="string"?x.className:h,y=S?new Error().stack?.split(`
`)[2]??"":"";if(Object.defineProperty(i,"name",{value:"<ai-"+K.replace(/\s+/g,"-")+y+">"}),S){let g=Object.keys(r).filter(T=>!["styles","ids","constructed","declare","override","iterable"].includes(T));g.length&&E.log(`${i.name} defines extraneous keys '${g}', which are unknown`)}return i}let N={createElement(a,c,...h){return a===N.createElement?d(...h):typeof a=="function"?a(c,h):typeof a=="string"&&a in N?N[a](c,h):a instanceof Node?a:de({error:new Error("Illegal type in createElement:"+a)})}};function ae(a){if(N[a])return N[a];let c=(r,...b)=>{let i=document;if(ce(r)&&(b.unshift(r),r={}),!ce(r)){if(r.debugger){debugger;delete r.debugger}r.document&&(i=r.document,delete r.document);let x=o?i.createElementNS(o,a.toLowerCase()):i.createElement(a);return x.constructor=c,v(x,l),p(x,r),x.append(...d(...b)),x}},h=Object.assign(c,{super:()=>{throw new Error("Can't invoke native elemenet constructors directly. Use document.createElement().")},extended:j,valueOf(){return`TagCreator: <${o||""}${o?"::":""}${a}>`}});return Object.defineProperty(c,Symbol.hasInstance,{value:O,writable:!0,configurable:!0}),Object.defineProperty(c,"name",{value:"<"+a+">"}),N[a]=h}return u.forEach(ae),N};function ue(){return document.createComment(S&&new Error("promise").stack?.replace(/^Error: /,"")||"promise")}function de({error:e}){return document.createComment(e instanceof Error?e.toString():`Error:
`+JSON.stringify(e,null,2))}var rt=function(){rt=function(){},new MutationObserver(e=>{e.forEach(function(t){t.type==="childList"&&t.removedNodes.forEach(n=>n&&n instanceof Element&&[...n.getElementsByTagName("*"),n].filter(o=>!o.isConnected).forEach(o=>{"onRemovedFromDOM"in o&&typeof o.onRemovedFromDOM=="function"&&o.onRemovedFromDOM()}))})}).observe(document.body,{subtree:!0,childList:!0})};function ot(e,t){let n=new WeakSet;function o(u){for(let s of u)t==="addedNodes"===s.isConnected&&(o(s.childNodes),n.add(s))}return new MutationObserver(u=>{u.forEach(function(s){s.type==="childList"&&s.removedNodes.length&&o(s[t])})}).observe(e,{subtree:!0,childList:!0}),function(u){return n.has(u)}}var De=new Set;function at(e,t){return e=e||document,t=t||Object.create(null),e.querySelectorAll&&e.querySelectorAll("[id]").forEach(function(n){n.id&&(t[n.id]?S&&(De.has(n.id)||(De.add(n.id),E.info("Shadowed multiple element IDs",n.id))):t[n.id]=n)}),t}export{Ce as Iterators,le as UniqueID,rt as enableOnRemovedFromDOM,at as getElementIdMap,nt as tag,ve as when};
