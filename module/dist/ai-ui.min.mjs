var ke=Object.defineProperty;var je=(e,t)=>{for(var n in t)ke(e,n,{get:t[n],enumerable:!0})};var M=globalThis.DEBUG=="*"||globalThis.DEBUG==!0||globalThis.DEBUG?.match(/(^|\W)AI-UI(\W|$)/)||!1;var Z=5e3,x={log(...e){M&&console.log("(AI-UI) LOG:",...e)},warn(...e){M&&console.warn("(AI-UI) WARN:",...e)},info(...e){M&&console.debug("(AI-UI) INFO:",...e)}};var ve=e=>{};function de(){let e=ve,t=ve,n=new Promise((...o)=>[e,t]=o);if(n.resolve=e,n.reject=t,M){let o=new Error().stack;n.catch(l=>l instanceof Error||l?.value instanceof Error?x.log("Deferred rejection",l,"allocated at ",o):void 0)}return n}function re(e){return e&&typeof e=="object"||typeof e=="function"}function F(e){return re(e)&&"then"in e&&typeof e.then=="function"}var Se={};je(Se,{Ignore:()=>H,Iterability:()=>J,asyncIterator:()=>ye,augmentGlobalAsyncGenerators:()=>Ve,combine:()=>Ae,debounceQueueIteratableIterator:()=>Pe,defineIterableProperty:()=>be,filterMap:()=>G,generatorHelpers:()=>He,isAsyncIter:()=>V,isAsyncIterable:()=>X,isAsyncIterator:()=>Y,iterableHelpers:()=>$,merge:()=>z,queueIteratableIterator:()=>pe});var J=Symbol("Iterability");function Y(e){return typeof e?.next=="function"}function X(e){return re(e)&&Symbol.asyncIterator in e&&typeof e[Symbol.asyncIterator]=="function"}function V(e){return X(e)||Y(e)}function ye(e){if(X(e))return e[Symbol.asyncIterator]();if(Y(e))return e;throw new Error("Not as async provider")}var se={filterMap(e,t=H){return G(this,e,t)},map:Ue,filter:We,unique:$e,waitFor:Ge,multi:Qe,initially:Fe,consume:we,merge(...e){return z(this,...e)},combine(e){return Ae(Object.assign({_this:this},e))}},fe=[...Object.getOwnPropertySymbols(se),...Object.keys(se)];function ae(e,t){let n=[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)];for(let o of n)Object.defineProperty(e,o,{...Object.getOwnPropertyDescriptor(t,o),enumerable:!1});return e}var j=Symbol("_pending"),W=Symbol("_items");function xe(e=()=>{}){let t={[j]:[],[W]:[],[Symbol.asyncIterator](){return t},next(){if(t[W]?.length)return Promise.resolve(t[W].shift());if(!t[j])return Promise.resolve({done:!0,value:void 0});let n=de();return n.catch(o=>{}),t[j].unshift(n),n},return(n){let o={done:!0,value:void 0};if(t[j]){try{e()}catch{}for(;t[j].length;)t[j].pop().resolve(o);t[W]=t[j]=null}return Promise.resolve(o)},throw(...n){let o={done:!0,value:n[0]};if(t[j]){try{e()}catch{}for(;t[j].length;)t[j].pop().reject(o);t[W]=t[j]=null}return Promise.reject(o)},get length(){return t[W]?t[W].length:-1},push(n){return t[j]?(t[j].length?t[j].pop().resolve({done:!1,value:n}):t[W]?t[W].push({done:!1,value:n}):x.log("Discarding queue push as there are no consumers"),!0):!1}};return $(t)}var oe=Symbol("inflight");function De(e=()=>{}){let t=xe(e);return t[oe]=new Set,t.push=function(n){if(!t[j])return!1;if(t[oe].has(n))return!0;if(t[oe].add(n),t[j].length){let o=t[j].pop();o.finally(()=>t[oe].delete(n)),o.resolve({done:!1,value:n})}else t[W]?t[W].find(o=>o===n)||t[W].push({done:!1,value:n}):x.log("Discarding queue push as there are no consumers");return!0},t}var pe=xe,Pe=De,B=Symbol("_proxiedAsyncIterator");function be(e,t,n){let o=()=>{o=()=>D;let m=Pe(),w=m.multi(),D=w[Symbol.asyncIterator]();return a[Symbol.asyncIterator]=w[Symbol.asyncIterator],b=m.push,fe.forEach(k=>a[k]=D[k]),B in g||ae(g,a),D};function l(m){return{[m]:function(...w){return o(),g[m].apply(this,w)}}[m]}let a={[Symbol.asyncIterator]:o};fe.forEach(m=>a[m]=l(m)),typeof n=="object"&&n&&J in n&&n[J]==="shallow"&&(a[J]=n[J]);let b=m=>(o(),b(m)),g=u(n,a),s;return Object.defineProperty(e,t,{get(){return g},set(m){if(m!==g)if(X(m)){if(s===m)return;s=m;let w=M?new Error:void 0;M&&x.info(new Error(`Iterable "${t.toString()}" has been assigned to consume another iterator. Did you mean to declare it?`)),we.call(m,D=>{if(m!==s)throw new Error(`Piped iterable "${t.toString()}" has been replaced by another iterator`,{cause:w});b(D?.valueOf())}).catch(D=>x.info(D)).finally(()=>m===s&&(s=void 0));return}else s&&M&&x.log(`Iterable "${t.toString()}" is already piped from another iterator, and might be overrwitten later`),g=u(m,a);b(m?.valueOf())},enumerable:!0}),e;function u(m,w){if(m==null)return ae(Object.create(null,{valueOf:{value(){return m},writable:!0},toJSON:{value(){return m},writable:!0}}),w);switch(typeof m){case"bigint":case"boolean":case"number":case"string":return ae(Object(m),Object.assign(w,{toJSON:{value(){return m.valueOf()},writable:!0}}));case"object":return K(m,w)}throw new TypeError('Iterable properties cannot be of type "'+typeof m+'"')}function d(m){return re(m)&&B in m}function P(m,w){let D=w.split(".").slice(1);for(let k=0;k<D.length&&(m=m?.[D[k]])!==void 0;k++);return m}function K(m,w){let D=new Map,k,ne;function c(f=""){return{has(h,r){return r===B||r===Symbol.toPrimitive||r in h||r in w},set(h,r,T,i){if(r in w)throw new Error(`Cannot set ${t.toString()}${f}.${r.toString()} as it is part of asyncIterator`);return Reflect.get(h,r,i)!==T&&b({[B]:{a:m,path:f}}),Reflect.set(h,r,T,i)},deleteProperty(h,r){if(r in w)throw new Error(`Cannot delete ${t.toString()}${f}.${r.toString()} as it is part of asyncIterator`);return Reflect.deleteProperty(h,r)},get(h,r,T){if(Object.hasOwn(w,r)){if(!f.length)return ne??(ne=G(w,N=>d(N)?N[B].a:N)),ne[r];let E=D.get(f);return E||(k??(k=G(w,N=>d(N)?N[B]:{a:N,path:""})),E=G(k,(N,y)=>{let p=P(N.a,f);return y!==p||N.path.startsWith(f)?p:H},H,P(m,f)),D.set(f,E)),E[r]}if(r===Symbol.toPrimitive)return function(E){return Reflect.has(h,r)?Reflect.get(h,r,h)(E):E==="string"?h.toString():E==="number"?+h.valueOf():h.constructor(h)};if(typeof r=="string"&&(r in h||Reflect.set(h,r,void 0,h),Object.hasOwn(h,r)))return new Proxy(Object(Reflect.get(h,r,h)),c(f+"."+r));let i=Reflect.get(h,r,h);return typeof i=="function"?i.bind(h):i}}}return new Proxy(m,c())}}var z=(...e)=>{let t=new Array(e.length),n=new Array(e.length),o=()=>{o=()=>{};for(let s=0;s<e.length;s++){let u=e[s];n[s]=(t[s]=Symbol.asyncIterator in u?u[Symbol.asyncIterator]():u).next().then(d=>({idx:s,result:d}))}},l=[],a=new Promise(()=>{}),b=n.length,g={[Symbol.asyncIterator](){return g},next(){return o(),b?Promise.race(n).then(({idx:s,result:u})=>u.done?(b--,n[s]=a,l[s]=u.value,g.next()):(n[s]=t[s]?t[s].next().then(d=>({idx:s,result:d})).catch(d=>({idx:s,result:{done:!0,value:d}})):Promise.resolve({idx:s,result:{done:!0,value:void 0}}),u)).catch(s=>g.throw?.(s)??Promise.reject({done:!0,value:new Error("Iterator merge exception")})):Promise.resolve({done:!0,value:l})},async return(s){for(let u=0;u<t.length;u++)n[u]!==a&&(n[u]=a,l[u]=await t[u]?.return?.({done:!0,value:s}).then(d=>d.value,d=>d));return{done:!0,value:l}},async throw(s){for(let u=0;u<t.length;u++)n[u]!==a&&(n[u]=a,l[u]=await t[u]?.throw?.(s).then(d=>d.value,d=>d));return{done:!0,value:l}}};return $(g)},Ae=(e,t={})=>{let n={},o,l=[],a=0,b=new Promise(()=>{}),g={[Symbol.asyncIterator](){return g},next(){return o===void 0&&(o=Object.entries(e).map(([s,u],d)=>(a+=1,l[d]=u[Symbol.asyncIterator](),l[d].next().then(P=>({si:l,idx:d,k:s,ir:P}))))),function s(){return Promise.race(o).then(({idx:u,k:d,ir:P})=>P.done?(o[u]=b,a-=1,a?s():{done:!0,value:void 0}):(n[d]=P.value,o[u]=l[u].next().then(K=>({idx:u,k:d,ir:K})),t.ignorePartial&&Object.keys(n).length<Object.keys(e).length?s():{done:!1,value:n}))}()},return(s){return o.forEach((u,d)=>{u!==b&&l[d].return?.(s)}),Promise.resolve({done:!0,value:s})},throw(s){return o.forEach((u,d)=>{u!==b&&l[d].throw?.(s)}),Promise.reject({done:!0,value:s})}};return $(g)};function Re(e){return X(e)&&fe.every(t=>t in e&&e[t]===se[t])}function $(e){return Re(e)||ae(e,se),e}function He(e){return function(...t){let n=e(...t);return $(n)}}async function we(e){let t;for await(let n of this)t=e?.(n);await t}var H=Symbol("Ignore");function Le(e,t,n){if(F(e))return e.then(t,n);try{return t(e)}catch(o){return n(o)}}function G(e,t,n=H,o=H){let l,a={[Symbol.asyncIterator](){return a},next(...b){if(n!==H){let g=Promise.resolve({done:!1,value:n});return n=H,g}return new Promise(function g(s,u){l||(l=e[Symbol.asyncIterator]()),l.next(...b).then(d=>d.done?s(d):Le(t(d.value,o),P=>P===H?g(s,u):s({done:!1,value:o=P}),P=>{l.throw?l.throw(P):l.return?.(P),u({done:!0,value:P})}),d=>u({done:!0,value:d})).catch(d=>{l.throw?l.throw(d):l.return?.(d),u({done:!0,value:d})})})},throw(b){return Promise.resolve(l?.throw?l.throw(b):l?.return?.(b)).then(g=>({done:!0,value:g?.value}))},return(b){return Promise.resolve(l?.return?.(b)).then(g=>({done:!0,value:g?.value}))}};return $(a)}function Ue(e){return G(this,e)}function We(e){return G(this,async t=>await e(t)?t:H)}function $e(e){return e?G(this,async(t,n)=>n===H||await e(t,n)?t:H):G(this,(t,n)=>t===n?H:t)}function Fe(e){return G(this,t=>t,e)}function Ge(e){return G(this,t=>new Promise(n=>(e(()=>n(t)),t)))}function Qe(){let e=this,t=0,n,o;function l(b){b&&n.resolve(b),b?.done||(n=de(),o.next().then(l).catch(g=>n.reject({done:!0,value:g})))}let a={[Symbol.asyncIterator](){return t+=1,a},next(){return o||(o=e[Symbol.asyncIterator](),l()),n},throw(b){if(t<1)throw new Error("AsyncIterator protocol error");return t-=1,t?Promise.resolve({done:!0,value:b}):Promise.resolve(o?.throw?o.throw(b):o?.return?.(b)).then(g=>({done:!0,value:g?.value}))},return(b){if(t<1)throw new Error("AsyncIterator protocol error");return t-=1,t?Promise.resolve({done:!0,value:b}):Promise.resolve(o?.return?.(b)).then(g=>({done:!0,value:g?.value}))}};return $(a)}function Ve(){let e=async function*(){}();for(;e;){if(Object.getOwnPropertyDescriptor(e,Symbol.asyncIterator)){$(e);break}e=Object.getPrototypeOf(e)}e||x.warn("Failed to augment the prototype of `(async function*())()`")}var ee=new Map;function qe(e){let t=ee.get(e.type);if(t)for(let n of t)try{let{push:o,terminate:l,container:a,selector:b}=n;if(a.isConnected){if(e.target instanceof Node)if(b){let g=a.querySelectorAll(b);for(let s of g)(e.target===s||s.contains(e.target))&&a.contains(s)&&o(e)}else(e.target===a||a.contains(e.target))&&o(e)}else{let g="Container `#"+a.id+">"+(b||"")+"` removed from DOM. Removing subscription";t.delete(n),l(new Error(g))}}catch(o){x.warn("docEventHandler",o)}}function me(e){return!!(e&&(e.startsWith("#")||e.startsWith(".")||e.startsWith("[")&&e.endsWith("]")))}function Ie(e){let t=e.split(":");if(t.length===1)return me(t[0])?[t[0],"change"]:[null,t[0]];if(t.length===2&&me(t[1])&&!me(t[0]))return[t[1],t[0]]}function Ke(e){throw new Error(e)}function he(e,t){let[n,o]=Ie(t)??Ke("Invalid WhenSelector: "+t);ee.has(o)||(document.addEventListener(o,qe,{passive:!0,capture:!0}),ee.set(o,new Set));let l=pe(()=>ee.get(o)?.delete(a)),a={push:l.push,terminate(b){l.return?.(b)},container:e,selector:n||null};return Ce(e,n?[n]:void 0).then(b=>ee.get(o).add(a)),l.multi()}async function*Oe(){await new Promise(()=>{}),yield void 0}function ge(e){function t(n){return e.map(n)}return Object.assign($(t),{[Symbol.asyncIterator]:()=>e[Symbol.asyncIterator]()})}function Be(e){if(!e)throw new Error(`Falsy async source will never be ready

`+JSON.stringify(e));return typeof e=="string"&&e[0]!=="@"&&!!Ie(e)}async function*Ye(e){yield e}function Te(e,...t){if(!t||t.length===0)return ge(he(e,"change"));let n=t.filter(a=>typeof a!="string"||a[0]!=="@").map(a=>typeof a=="string"?he(e,a):a instanceof Element?he(a,"change"):F(a)?Ye(a):a);if(t.includes("@start")){let a={[Symbol.asyncIterator]:()=>a,next(){return a.next=()=>Promise.resolve({done:!0,value:void 0}),Promise.resolve({done:!1,value:{}})}};n.push(a)}if(t.includes("@ready")){let b=function(d){return typeof d=="string"&&!e.querySelector(d)};var l=b;let g=t.filter(Be).map(d=>Ie(d)?.[0]).filter(b),s,u={[Symbol.asyncIterator](){return u},throw(d){return s?.throw?s.throw(d):Promise.resolve({done:!0,value:d})},return(d){return s?.return?s.return(d):Promise.resolve({done:!0,value:d})},next(){return s?s.next():Ce(e,g).then(()=>(s=(n.length>1?z(...n):n.length===1?n[0]:Oe())[Symbol.asyncIterator](),s?{done:!1,value:{}}:{done:!0,value:void 0}))}};return ge($(u))}let o=n.length>1?z(...n):n.length===1?n[0]:Oe();return ge($(o))}function Me(e){return e.isConnected?Promise.resolve():new Promise(t=>new MutationObserver((n,o)=>{n.some(l=>l.addedNodes?.length)&&e.isConnected&&(o.disconnect(),t())}).observe(document.body,{subtree:!0,childList:!0}))}function Ce(e,t){return t?.length?Promise.all([_e(e,t),Me(e)]):Me(e)}function _e(e,t){if(t=t.filter(o=>!e.querySelector(o)),!t.length)return Promise.resolve();let n=new Promise(o=>new MutationObserver((l,a)=>{l.some(b=>b.addedNodes?.length)&&t.every(b=>e.querySelector(b))&&(a.disconnect(),o())}).observe(e,{subtree:!0,childList:!0}));if(M){let o=new Error().stack?.replace(/^Error/,"Missing selectors after 5 seconds:"),l=setTimeout(()=>{x.warn(o,t)},Z);n.finally(()=>clearTimeout(l))}return n}var ie=Symbol("Unique ID"),q=M?e=>`"${"innerHTML"in e?e.innerHTML:e.textContent}"`:e=>{},Ze=0,Je=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","menu","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","script","search","section","select","slot","small","source","span","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"],Xe=Object.getOwnPropertyDescriptors({get ids(){return nt(this)},set ids(e){throw new Error("Cannot set ids on "+this.valueOf())},when:function(...e){return Te(this,...e)}}),ue=document.createElement("STYLE");ue.id="--ai-ui-extended-tag-styles-";function le(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||e instanceof Node||e instanceof NodeList||e instanceof HTMLCollection||e===null||e===void 0||Array.isArray(e)||F(e)||V(e)||typeof e=="object"&&Symbol.iterator in e&&typeof e[Symbol.iterator]=="function"}var te=Symbol("callStack"),ze=function(e,t,n){let[o,l,a]=typeof e=="string"||e===null?[e,t,n]:Array.isArray(e)?[null,e,t]:[null,Je,e],b=tt(document,"removedNodes"),g=a?.commonProperties,s=Object.create(null,Xe);Object.defineProperty(s,"attributes",{...Object.getOwnPropertyDescriptor(Element.prototype,"attributes"),set(c){if(V(c)){let f=Y(c)?c:c[Symbol.asyncIterator](),h=()=>f.next().then(({done:r,value:T})=>{m(this,T),r||h()},r=>x.warn(r));h()}else m(this,c)}}),g&&P(s,g);function u(...c){let f=[];return function h(r){if(!(r==null||r===H)){if(F(r)){let T=Ee();f.push(T),r.then(i=>T.replaceWith(...u(i)),i=>{x.warn(i,q(T)),T.replaceWith(ce({error:i}))});return}if(r instanceof Node){f.push(r);return}if(r&&typeof r=="object"&&Symbol.iterator in r&&!(Symbol.asyncIterator in r)&&r[Symbol.iterator]){for(let T of r)h(T);return}if(V(r)){let T=M?`
`+new Error().stack?.replace(/^Error: /,"Insertion :"):"",i=Y(r)?r:r[Symbol.asyncIterator](),E=r.valueOf(),N=E===void 0||E===r?[Ee()]:u(E);f.push(...N);let y=N,p=!0,I=Date.now()+Z,A=M&&new Error("Created by").stack,L=S=>{let O=y.filter(R=>!!R?.parentNode);O.length?(y=[ce({error:S})],O[0].replaceWith(...y),O.slice(1).forEach(R=>R?.parentNode.removeChild(R))):x.warn("Can't report error",S,A,y.map(q)),y=[],i.return?.(L)},Q=S=>{if(!S.done)try{let O=y.filter(v=>v?.parentNode&&v.isConnected),R=p?y:O;if(O.length&&(p=!1),!R.length||y.every(v=>b(v))){y=[];let v="Element(s) have been removed from the document: "+T;i.return?.(new Error(v));return}M&&p&&I&&I<Date.now()&&(I=Number.MAX_SAFE_INTEGER,x.warn("Async element not mounted after 5 seconds. If it is never mounted, it will leak.",A,y.map(q))),y=u(K(S.value)),y.length||y.push(Ee()),R[0].replaceWith(...y),R.slice(1).forEach(v=>!y.includes(v)&&v.parentNode?.removeChild(v)),i.next().then(Q).catch(L)}catch(O){y=[],i.return?.(O)}};i.next().then(Q).catch(L);return}f.push(document.createTextNode(r.toString()))}}(c),f}o||Object.assign(ze,{nodes:u,UniqueID:ie});let d=Object.getPrototypeOf({});function P(c,f,h){if(!(f==null||typeof f!="object"||f===c))for(let[r,T]of Object.entries(Object.getOwnPropertyDescriptors(f)))try{if("value"in T){let i=T.value;i&&V(i)?Object.defineProperty(c,r,T):i&&typeof i=="object"&&!F(i)?r in c?i instanceof Node?(x.info("Having DOM Nodes as properties of other DOM Nodes is a bad idea as it makes the DOM tree into a cyclic graph. You should reference nodes by ID or as a child",r,q(i)),c[r]=i):c[r]!==i&&(Array.isArray(c[r])&&c[r].length!==i.length?i.constructor===Object||i.constructor===Array?P(c[r]=new i.constructor,i):c[r]=i:P(c[r],i)):(h&&(Object.getPrototypeOf(i)===d||!Object.getPrototypeOf(i)?P(T.value={},i):Array.isArray(i)?P(T.value=[],i):x.warn(`Declared propety '${r}' is not a plain object and must be assigned by reference, possibly polluting other instances of this tag`,c,i)),Object.defineProperty(c,r,T)):f[r]!==void 0&&(c[r]=f[r])}else Object.defineProperty(c,r,T)}catch(i){throw x.warn("deepAssign",r,f[r],i),i}}function K(c){let f=c?.valueOf();return Array.isArray(f)?Array.prototype.map.call(f,K):f}function m(c,f){te in f||function h(r,T){if(T==null||typeof T!="object")return;let i=Object.entries(Object.getOwnPropertyDescriptors(T));Array.isArray(T)||i.sort((y,p)=>{let I=Object.getOwnPropertyDescriptor(r,y[0]);if(I){if("value"in I)return-1;if("set"in I)return 1;if("get"in I)return .5}return 0});for(let[y,p]of i)try{if("value"in p){let I=p.value;V(I)?E(I,y):F(I)?I.then(A=>{A&&typeof A=="object"?V(A)?E(A,y):N(A,y):T[y]!==void 0&&(r[y]=A)},A=>x.log("Failed to set attribute",A)):V(I)||(I&&typeof I=="object"&&!F(I)?N(I,y):T[y]!==void 0&&(r[y]=T[y]))}else Object.defineProperty(r,y,p)}catch(I){throw x.warn("assignProps",y,T[y],I),I}function E(y,p){let I=ye(y),A=!0,L=Date.now()+Z,Q=M&&new Error("Created by").stack,S=R=>{if(!R.done){let v=K(R.value);if(typeof v=="object"&&v!==null){let U=Object.getOwnPropertyDescriptor(r,p);p==="style"||!U?.set?h(r[p],v):r[p]=v}else v!==void 0&&(r[p]=v);let C=c.isConnected;if(b(c)||!A&&!C){x.info(`Element does not exist in document when setting async attribute '${p}' to:
${q(c)}`),I.return?.();return}C&&(A=!1),A&&L&&L<Date.now()&&(L=Number.MAX_SAFE_INTEGER,x.warn(`Element with async attribute '${p}' not mounted after 5 seconds. If it is never mounted, it will leak.
Element contains: ${q(c)}
${Q}`)),I.next().then(S).catch(O)}},O=R=>{x.warn("Dynamic attribute error",R,p,r,Q,q(c)),I.return?.(R),c.appendChild(ce({error:R}))};I.next().then(S).catch(O)}function N(y,p){if(y instanceof Node)x.info("Having DOM Nodes as properties of other DOM Nodes is a bad idea as it makes the DOM tree into a cyclic graph. You should reference nodes by ID or via a collection such as .childNodes",p,q(y)),r[p]=y;else if(!(p in r)||r[p]===y||Array.isArray(r[p])&&r[p].length!==y.length)if(y.constructor===Object||y.constructor===Array){let I=new y.constructor;h(I,y),r[p]=I}else r[p]=y;else Object.getOwnPropertyDescriptor(r,p)?.set?r[p]=y:h(r[p],y)}}(c,f)}function w(c){for(let f=c.constructor;f;f=f.super)if(f===this)return!0;return!1}function D(c){let f=typeof c!="function"?p=>Object.assign({},c,p):c,h=Date.now().toString(36)+(Ze++).toString(36)+Math.random().toString(36).slice(2),r=f({[ie]:h});r.styles&&(ue.appendChild(document.createTextNode(r.styles+`
`)),document.head.contains(ue)||document.head.appendChild(ue));let i=Object.assign((p,...I)=>{let A=le(p),L=[],Q={[te]:(A?L:p[te])??L},S=A?this(Q,p,...I):this(Q,...I);S.constructor=i;let O=f({[ie]:h});if(Q[te].push(O),M){let v=function(C,U){for(let _=C;_;_=_.super)if(_.definition?.declare&&U in _.definition.declare)return!0;return!1};var R=v;if(O.declare){let C=Object.keys(O.declare).filter(U=>U in S||v(this,U));C.length&&x.log(`Declared keys '${C}' in ${i.name} already exist in base '${this.valueOf()}'`)}if(O.override){let C=Object.keys(O.override).filter(U=>!(U in S)&&!(g&&U in g)&&!v(this,U));C.length&&x.log(`Overridden keys '${C}' in ${i.name} do not exist in base '${this.valueOf()}'`)}}if(P(S,O.declare,!0),P(S,O.override),O.iterable&&Object.keys(O.iterable).forEach(v=>{v in S?x.log(`Ignoring attempt to re-define iterable property "${v}" as it could already have consumers`):be(S,v,O.iterable[v])}),Q[te]===L){A||m(S,p);for(let v of L){let C=v?.constructed?.call(S);le(C)&&S.append(...u(C))}for(let v of L)if(v.iterable){for(let C of Object.keys(v.iterable))if(!(!A&&C in p&&(!F(p[C])||!V(p[C])))){let U=S[C];U?.valueOf()!==void 0&&(S[C]=U)}}}return S},{super:this,definition:Object.assign(r,{[ie]:h}),extended:D,valueOf:()=>{let p=[...Object.keys(r.declare||{}),...Object.keys(r.iterable||{})];return`${i.name}: {${p.join(", ")}}
 \u21AA ${this.valueOf()}`}});Object.defineProperty(i,Symbol.hasInstance,{value:w,writable:!0,configurable:!0});let E={};(function p(I){I?.super&&p(I.super);let A=I.definition;A&&(P(E,A?.override),P(E,A?.declare))})(this),P(E,r.override),P(E,r.declare),Object.defineProperties(i,Object.getOwnPropertyDescriptors(E));let N=E&&"className"in E&&typeof E.className=="string"?E.className:h,y=M?new Error().stack?.split(`
`)[2]??"":"";if(Object.defineProperty(i,"name",{value:"<ai-"+N.replace(/\s+/g,"-")+y+">"}),M){let p=Object.keys(r).filter(I=>!["styles","ids","constructed","declare","override","iterable"].includes(I));p.length&&x.log(`${i.name} defines extraneous keys '${p}', which are unknown`)}return i}let k={createElement(c,f,...h){return c===k.createElement?u(...h):typeof c=="function"?c(f,h):typeof c=="string"&&c in k?k[c](f,h):c instanceof Node?c:ce({error:new Error("Illegal type in createElement:"+c)})}};function ne(c){if(k[c])return k[c];let f=(r,...T)=>{let i=document;if(le(r)&&(T.unshift(r),r={}),!le(r)){if(r.debugger){debugger;delete r.debugger}r.document&&(i=r.document,delete r.document);let E=o?i.createElementNS(o,c.toLowerCase()):i.createElement(c);return E.constructor=f,P(E,s),m(E,r),E.append(...u(...T)),E}},h=Object.assign(f,{super:()=>{throw new Error("Can't invoke native elemenet constructors directly. Use document.createElement().")},extended:D,valueOf(){return`TagCreator: <${o||""}${o?"::":""}${c}>`}});return Object.defineProperty(f,Symbol.hasInstance,{value:w,writable:!0,configurable:!0}),Object.defineProperty(f,"name",{value:"<"+c+">"}),k[c]=h}return l.forEach(ne),k};function Ee(){return document.createComment(M&&new Error("promise").stack?.replace(/^Error: /,"")||"promise")}function ce({error:e}){return document.createComment(e instanceof Error?e.toString():`Error:
`+JSON.stringify(e,null,2))}var et=function(){et=function(){},new MutationObserver(e=>{e.forEach(function(t){t.type==="childList"&&t.removedNodes.forEach(n=>n&&n instanceof Element&&[...n.getElementsByTagName("*"),n].filter(o=>!o.isConnected).forEach(o=>{"onRemovedFromDOM"in o&&typeof o.onRemovedFromDOM=="function"&&o.onRemovedFromDOM()}))})}).observe(document.body,{subtree:!0,childList:!0})};function tt(e,t){let n=new WeakSet;function o(l){for(let a of l)t==="addedNodes"===a.isConnected&&(o(a.childNodes),n.add(a))}return new MutationObserver(l=>{l.forEach(function(a){a.type==="childList"&&a.removedNodes.length&&o(a[t])})}).observe(e,{subtree:!0,childList:!0}),function(l){return n.has(l)}}var Ne=new Set;function nt(e,t){return e=e||document,t=t||Object.create(null),e.querySelectorAll&&e.querySelectorAll("[id]").forEach(function(n){n.id&&(t[n.id]?M&&(Ne.has(n.id)||(Ne.add(n.id),x.info("Shadowed multiple element IDs",n.id))):t[n.id]=n)}),t}export{Se as Iterators,ie as UniqueID,et as enableOnRemovedFromDOM,nt as getElementIdMap,ze as tag,Te as when};
