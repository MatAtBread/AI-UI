var We=Object.defineProperty;var Ue=(e,t)=>{for(var n in t)We(e,n,{get:t[n],enumerable:!0})};var C=globalThis.DEBUG=="*"||globalThis.DEBUG==!0||!!globalThis.DEBUG?.match(/(^|\W)AI-UI(\W|$)/)||!1;var J=5e3,I={log(...e){C&&console.log("(AI-UI) LOG:",...e,new Error().stack?.replace(/Error\n\s*.*\n/,`
`))},warn(...e){C&&console.warn("(AI-UI) WARN:",...e,new Error().stack?.replace(/Error\n\s*.*\n/,`
`))},info(...e){C&&console.trace("(AI-UI) INFO:",...e)}};var Se=e=>{};function ge(){let e=Se,t=Se,n=new Promise((...a)=>[e,t]=a);if(n.resolve=e,n.reject=t,C){let a=new Error().stack;n.catch(u=>u instanceof Error||u?.value instanceof Error?I.log("Deferred rejection",u,"allocated at ",a):void 0)}return n}function le(e){return e&&typeof e=="object"||typeof e=="function"}function X(e){return le(e)&&"then"in e&&typeof e.then=="function"}var Re={};Ue(Re,{Ignore:()=>R,Iterability:()=>re,asyncExtras:()=>ce,asyncIterator:()=>Te,augmentGlobalAsyncGenerators:()=>Ze,combine:()=>Ne,debounceQueueIteratableIterator:()=>ke,defineIterableProperty:()=>ve,filterMap:()=>_,generatorHelpers:()=>$e,isAsyncIter:()=>Q,isAsyncIterable:()=>ue,isAsyncIterator:()=>ae,iterableHelpers:()=>q,merge:()=>de,queueIteratableIterator:()=>Ie});var re=Symbol("Iterability");function ae(e){return le(e)&&"next"in e&&typeof e?.next=="function"}function ue(e){return le(e)&&Symbol.asyncIterator in e&&typeof e[Symbol.asyncIterator]=="function"}function Q(e){return ue(e)||ae(e)}function Te(e){if(ae(e))return e;if(ue(e))return e[Symbol.asyncIterator]();throw new Error("Not an async provider")}var ce={filterMap(e,t=R){return _(this,e,t)},map:Ge,filter:Qe,unique:qe,waitFor:_e,multi:Ye,initially:Xe,consume:Me,merge(...e){return de(this,...e)},combine(e){return Ne(Object.assign({_this:this},e))}},he=[...Object.getOwnPropertySymbols(ce),...Object.keys(ce)];function pe(e,t){let n=[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)];for(let a of n)Object.defineProperty(e,a,{...Object.getOwnPropertyDescriptor(t,a),enumerable:!1});return e}var H=Symbol("pending"),G=Symbol("items");function De(e=()=>{}){let t={[H]:[],[G]:[],[Symbol.asyncIterator](){return t},next(){if(t[G]?.length)return Promise.resolve(t[G].shift());if(!t[H])return Promise.resolve({done:!0,value:void 0});let n=ge();return n.catch(a=>{}),t[H].unshift(n),n},return(n){let a={done:!0,value:void 0};if(t[H]){try{e()}catch{}for(;t[H].length;)t[H].pop().resolve(a);t[G]=t[H]=null}return Promise.resolve(a)},throw(...n){let a={done:!0,value:n[0]};if(t[H]){try{e()}catch{}for(;t[H].length;)t[H].pop().reject(a);t[G]=t[H]=null}return Promise.reject(a)},get length(){return t[G]?t[G].length:-1},push(n){return t[H]?(t[H].length?t[H].pop().resolve({done:!1,value:n}):t[G]?t[G].push({done:!1,value:n}):I.log("Discarding queue push as there are no consumers"),!0):!1}};return q(t)}var fe=Symbol("inflight");function Le(e=()=>{}){let t=De(e);return t[fe]=new Set,t.push=function(n){if(!t[H])return!1;if(t[fe].has(n))return!0;if(t[H].length){t[fe].add(n);let a=t[H].pop();a.finally(()=>t[fe].delete(n)),a.resolve({done:!1,value:n})}else t[G]?t[G].find(a=>a.value===n)||t[G].push({done:!1,value:n}):I.log("Discarding queue push as there are no consumers");return!0},t}var Ie=De,ke=Le,ne=Symbol("_proxiedAsyncIterator");function ve(e,t,n){let a=()=>{a=()=>K;let b=ke(),A=b.multi(),K=A[Symbol.asyncIterator]();return y[Symbol.asyncIterator]=A[Symbol.asyncIterator],l=b.push,he.forEach(k=>y[k]=K[k]),ne in o||pe(o,y),K};function u(b){return{[b]:function(...A){return a(),o[b].apply(this,A)}}[b]}let y={[Symbol.asyncIterator]:a};he.forEach(b=>y[b]=u(b)),typeof n=="object"&&n&&re in n&&n[re]==="shallow"&&(y[re]=n[re]);let l=b=>(a(),l(b)),o=p(n,y),i;return Object.defineProperty(e,t,{get(){return o},set(b){if(b!==o)if(ue(b)){if(i===b)return;i=b;let A=C?new Error:void 0;C&&I.info(new Error(`Iterable "${t.toString()}" has been assigned to consume another iterator. Did you mean to declare it?`)),Me.call(b,K=>{if(b!==i)throw new Error(`Piped iterable "${t.toString()}" has been replaced by another iterator`,{cause:A});l(K?.valueOf())}).catch(K=>I.info(K)).finally(()=>b===i&&(i=void 0));return}else i&&C&&I.log(`Iterable "${t.toString()}" is already piped from another iterator, and might be overrwitten later`),o=p(b,y);l(b?.valueOf())},enumerable:!0}),e;function p(b,A){if(b==null)return pe(Object.create(null,{valueOf:{value(){return b},writable:!0,configurable:!0},toJSON:{value(){return b},writable:!0,configurable:!0}}),A);switch(typeof b){case"bigint":case"boolean":case"number":case"string":return pe(Object(b),Object.assign(A,{toJSON(){return b.valueOf()}}));case"object":return ye(b,A)}throw new TypeError('Iterable properties cannot be of type "'+typeof b+'"')}function g(b){return le(b)&&ne in b}function B(b,A){let K=A.split(".").slice(1);for(let k=0;k<K.length&&(b=b?.[K[k]])!==void 0;k++);return b}function ye(b,A){let K,k;return new Proxy(b,se());function se(L=""){return{has(D,E){return E===ne||E===Symbol.toPrimitive||E in D||E in A},set(D,E,F,j){if(Object.hasOwn(A,E))throw new Error(`Cannot set ${t.toString()}${L}.${E.toString()} as it is part of asyncIterator`);return Reflect.get(D,E,j)!==F&&l({[ne]:{a:b,path:L}}),Reflect.set(D,E,F,j)},deleteProperty(D,E){return Reflect.deleteProperty(D,E)?(l({[ne]:{a:b,path:L}}),!0):!1},get(D,E,F){if(Object.hasOwn(A,E))return L.length?(K??(K=_(A,s=>g(s)?s[ne]:{a:s,path:null})),_(K,(s,c)=>{let h=B(s.a,L);return c!==h||s.path===null||s.path.startsWith(L)?h:R},R,B(b,L))[E]):(k??(k=_(A,j=>g(j)?j[ne].a:j)),k[E]);if(E==="valueOf")return()=>B(b,L);if(E===Symbol.toPrimitive)return function(j){return Reflect.has(D,E)?Reflect.get(D,E,D).call(D,j):j==="string"?D.toString():j==="number"?Number(D):D.valueOf()};if(typeof E=="string"&&(!(E in D)||Object.hasOwn(D,E))&&!(re in D&&D[re]==="shallow")){let j=Reflect.get(D,E,F);return typeof j=="function"||Q(j)?j:new Proxy(Object(j),se(L+"."+E))}return Reflect.get(D,E,F)}}}}}var te=new Promise(()=>{}),de=(...e)=>{let t=new Array(e.length),n=new Array(e.length),a=()=>{a=()=>{};for(let o=0;o<e.length;o++){let i=e[o];n[o]=(t[o]=Symbol.asyncIterator in i?i[Symbol.asyncIterator]():i).next().then(p=>({idx:o,result:p}))}},u=[],y=n.length,l={[Symbol.asyncIterator](){return l},next(){return a(),y?Promise.race(n).then(({idx:o,result:i})=>i.done?(y--,n[o]=te,u[o]=i.value,l.next()):(n[o]=t[o]?t[o].next().then(p=>({idx:o,result:p})).catch(p=>({idx:o,result:{done:!0,value:p}})):Promise.resolve({idx:o,result:{done:!0,value:void 0}}),i)).catch(o=>l.throw?.(o)??Promise.reject({done:!0,value:new Error("Iterator merge exception")})):Promise.resolve({done:!0,value:u})},async return(o){for(let i=0;i<t.length;i++)n[i]!==te&&(n[i]=te,u[i]=await t[i]?.return?.({done:!0,value:o}).then(p=>p.value,p=>p));return{done:!0,value:u}},async throw(o){for(let i=0;i<t.length;i++)n[i]!==te&&(n[i]=te,u[i]=await t[i]?.throw?.(o).then(p=>p.value,p=>p));return{done:!0,value:u}}};return q(l)},Ne=(e,t={})=>{let n={},a,u=[],y=0,l={[Symbol.asyncIterator](){return l},next(){return a===void 0&&(a=Object.entries(e).map(([o,i],p)=>(y+=1,u[p]=i[Symbol.asyncIterator](),u[p].next().then(g=>({si:u,idx:p,k:o,ir:g}))))),function o(){return Promise.race(a).then(({idx:i,k:p,ir:g})=>g.done?(a[i]=te,y-=1,y?o():{done:!0,value:void 0}):(n[p]=g.value,a[i]=u[i].next().then(B=>({idx:i,k:p,ir:B})),t.ignorePartial&&Object.keys(n).length<Object.keys(e).length?o():{done:!1,value:n}))}()},return(o){return a.forEach((i,p)=>{i!==te&&u[p].return?.(o)}),Promise.resolve({done:!0,value:o})},throw(o){return a.forEach((i,p)=>{i!==te&&u[p].throw?.(o)}),Promise.reject({done:!0,value:o})}};return q(l)};function Fe(e){return ue(e)&&he.every(t=>t in e&&e[t]===ce[t])}function q(e){return Fe(e)||pe(e,ce),e}function $e(e){return function(...t){let n=e(...t);return q(n)}}async function Me(e){let t;for await(let n of this)t=e?.(n);await t}var R=Symbol("Ignore");function Ve(e,t,n){if(X(e))return e.then(t,n);try{return t(e)}catch(a){return n(a)}}function _(e,t,n=R,a=R){let u,y={[Symbol.asyncIterator](){return y},next(...l){if(n!==R){let o=Promise.resolve({done:!1,value:n});return n=R,o}return new Promise(function o(i,p){u||(u=e[Symbol.asyncIterator]()),u.next(...l).then(g=>g.done?(a=R,i(g)):Ve(t(g.value,a),B=>B===R?o(i,p):i({done:!1,value:a=B}),B=>{a=R,u.throw?u.throw(B):u.return?.(B),p({done:!0,value:B})}),g=>{a=R,p({done:!0,value:g})}).catch(g=>{a=R,u.throw?u.throw(g):u.return?.(g),p({done:!0,value:g})})})},throw(l){return Promise.resolve(u?.throw?u.throw(l):u?.return?.(l)).then(o=>({done:!0,value:o?.value}))},return(l){return Promise.resolve(u?.return?.(l)).then(o=>({done:!0,value:o?.value}))}};return q(y)}function Ge(e){return _(this,e)}function Qe(e){return _(this,async t=>await e(t)?t:R)}function qe(e){return e?_(this,async(t,n)=>n===R||await e(t,n)?t:R):_(this,(t,n)=>t===n?R:t)}function Xe(e){return _(this,t=>t,e)}function _e(e){return _(this,t=>new Promise(n=>(e(()=>n(t)),t)))}function Ye(){let e=this,t=0,n,a;function u(l){l&&n.resolve(l),l?.done?n=null:(n=ge(),a.next().then(u).catch(o=>{n.reject({done:!0,value:o}),n=null}))}let y={[Symbol.asyncIterator](){return t+=1,y},next(){return a||(a=e[Symbol.asyncIterator](),u()),n},throw(l){if(t<1)throw new Error("AsyncIterator protocol error");return t-=1,t?Promise.resolve({done:!0,value:l}):Promise.resolve(a?.throw?a.throw(l):a?.return?.(l)).then(o=>({done:!0,value:o?.value}))},return(l){if(t<1)throw new Error("AsyncIterator protocol error");return t-=1,t?Promise.resolve({done:!0,value:l}):Promise.resolve(a?.return?.(l)).then(o=>({done:!0,value:o?.value}))}};return q(y)}function Ze(){let e=async function*(){}();for(;e;){if(Object.getOwnPropertyDescriptor(e,Symbol.asyncIterator)){q(e);break}e=Object.getPrototypeOf(e)}e||I.warn("Failed to augment the prototype of `(async function*())()`")}var ee=new WeakMap;function Je(e){ee.has(this)||ee.set(this,new Map);let t=ee.get(this).get(e.type);if(t)for(let n of t)try{let{push:a,terminate:u,containerRef:y,selector:l,includeChildren:o}=n,i=y.deref();if(!i||!i.isConnected){let p="Container `#"+i?.id+">"+(l||"")+"` removed from DOM. Removing subscription";t.delete(n),u(new Error(p))}else if(e.target instanceof Node)if(l){let p=i.querySelectorAll(l);for(let g of p)(o?g.contains(e.target):e.target===g)&&i.contains(g)&&a(e)}else(o?i.contains(e.target):e.target===i)&&a(e)}catch(a){I.warn("docEventHandler",a)}}function xe(e){return!!(e&&(e.startsWith("#")||e.startsWith(".")||e.startsWith("[")&&e.endsWith("]")))}function je(e){let t=!e||!e.endsWith(">");return{includeChildren:t,selector:t?e:e.slice(0,-1)}}function Ae(e){let t=e.split(":");if(t.length===1)return xe(t[0])?[je(t[0]),"change"]:[{includeChildren:!0,selector:null},t[0]];if(t.length===2&&xe(t[1])&&!xe(t[0]))return[je(t[1]),t[0]]}function ze(e){throw new Error(e)}function Ee(e,t){let[{includeChildren:n,selector:a},u]=Ae(t)??ze("Invalid WhenSelector: "+t);ee.has(e.ownerDocument)||ee.set(e.ownerDocument,new Map),ee.get(e.ownerDocument).has(u)||(e.ownerDocument.addEventListener(u,Je,{passive:!0,capture:!0}),ee.get(e.ownerDocument).set(u,new Set));let y=Ie(()=>ee.get(e.ownerDocument)?.get(u)?.delete(l)),l={push:y.push,terminate(o){y.return?.(o)},containerRef:new WeakRef(e),includeChildren:n,selector:a};return Be(e,a?[a]:void 0).then(o=>ee.get(e.ownerDocument)?.get(u).add(l)),y.multi()}async function*et(){return I.log("doneImmediately"),void 0}function Pe(e){function t(n){return e.map(n)}return Object.assign(q(t),{[Symbol.asyncIterator]:()=>e[Symbol.asyncIterator]()})}function tt(e){if(!e)throw new Error(`Falsy async source will never be ready

`+JSON.stringify(e));return typeof e=="string"&&e[0]!=="@"&&!!Ae(e)}async function*nt(e){yield e}function Ce(e,...t){if(!t||t.length===0)return Pe(Ee(e,"change"));let n=t.filter(y=>typeof y!="string"||y[0]!=="@").map(y=>typeof y=="string"?Ee(e,y):y instanceof Element?Ee(y,"change"):X(y)?nt(y):y);if(t.includes("@start")){let y={[Symbol.asyncIterator]:()=>y,next(){return y.next=()=>Promise.resolve({done:!0,value:void 0}),Promise.resolve({done:!1,value:{}})}};n.push(y)}if(t.includes("@ready")){let l=function(g){return typeof g=="string"&&!e.querySelector(g)};var u=l;let o=t.filter(tt).map(g=>Ae(g)?.[0]).map(g=>g?.selector).filter(l),i,p={[Symbol.asyncIterator](){return p},throw(g){return i?.throw?i.throw(g):Promise.resolve({done:!0,value:g})},return(g){return i?.return?i.return(g):Promise.resolve({done:!0,value:g})},next(){return i?i.next():Be(e,o).then(()=>(i=(n.length>1?de(...n):n.length===1?n[0]:void 0)?.[Symbol.asyncIterator](),i?{done:!1,value:{}}:{done:!0,value:void 0}))}};return Pe(q(p))}let a=n.length>1?de(...n):n.length===1?n[0]:et();return Pe(q(a))}function Be(e,t){function n(){if(e.isConnected)return Promise.resolve();let u,y=new Promise((l,o)=>(u=o,new MutationObserver((i,p)=>{i.some(g=>g.addedNodes?.length)&&e.isConnected&&(p.disconnect(),l()),i.some(g=>[...g.removedNodes].includes(e))&&(p.disconnect(),o(new Error("Removed from DOM")))}).observe(e.ownerDocument.body,{subtree:!0,childList:!0})));if(C){let l=new Error().stack?.replace(/^Error/,`Element not mounted after ${J/1e3} seconds:`),o=setTimeout(()=>{I.warn(l+`
`+e.outerHTML)},J);y.finally(()=>clearTimeout(o))}return y}function a(u){if(u=u.filter(l=>!e.querySelector(l)),!u.length)return Promise.resolve();let y=new Promise(l=>new MutationObserver((o,i)=>{o.some(p=>p.addedNodes?.length)&&u.every(p=>e.querySelector(p))&&(i.disconnect(),l())}).observe(e,{subtree:!0,childList:!0}));if(C){let l=new Error().stack?.replace(/^Error/,`Missing selectors after ${J/1e3} seconds: `)??"??",o=setTimeout(()=>{I.warn(l+u+`
`)},J);y.finally(()=>clearTimeout(o))}return y}return t?.length?n().then(()=>a(t)):n()}var ie=Symbol("callStack");var be=Symbol("Unique ID"),z=C?e=>`"${"innerHTML"in e?e.innerHTML:e.textContent}"`:e=>{},rt=0,ot=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","menu","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","script","search","section","select","slot","small","source","span","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"];function oe(){throw new Error("<elt>.ids is a read-only map of Elements")}var He=[...Object.keys(Object.getOwnPropertyDescriptors(Function.prototype))].reduce((e,t)=>(e[t]=Symbol(t),e),{});function Ke(e){return e in He?He[e]:e}function me(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||e instanceof Node||e instanceof NodeList||e instanceof HTMLCollection||e===null||e===void 0||Array.isArray(e)||X(e)||Q(e)||typeof e=="object"&&Symbol.iterator in e&&typeof e[Symbol.iterator]=="function"}var st=function(e,t,n){let[a,u,y]=typeof e=="string"||e===null?[e,t,n]:Array.isArray(e)?[null,e,t]:[null,ot,e],l=y?.commonProperties,o=y?.document??globalThis.document,i=at(o,"removedNodes",y?.enableOnRemovedFromDOM);function p(){return o.createComment(C&&new Error("promise").stack?.replace(/^Error: /,"")||"promise")}function g({error:s}){return o.createComment(s instanceof Error?s.toString():`Error:
`+JSON.stringify(s,null,2))}let B=o.createElement("STYLE");B.id="--ai-ui-extended-tag-styles-"+Date.now();let ye=new Set,b=Object.create(null,{when:{writable:!1,configurable:!0,enumerable:!1,value:function(...s){return Ce(this,...s)}},attributes:{...Object.getOwnPropertyDescriptor(Element.prototype,"attributes"),set(s){if(Q(s)){let c=ae(s)?s:s[Symbol.asyncIterator](),h=()=>c.next().then(({done:r,value:T})=>{L(this,T),r||h()},r=>I.warn(r));h()}else L(this,s)}},ids:{configurable:!0,enumerable:!0,set:oe,get(){let s=new Proxy(()=>{},{apply(c,h,r){try{return h.constructor.definition.ids[r[0].id](...r)}catch(T){throw new Error(`<elt>.ids.${r?.[0]?.id} is not a tag-creating function`,{cause:T})}},construct:oe,defineProperty:oe,deleteProperty:oe,set:oe,setPrototypeOf:oe,getPrototypeOf(){return null},isExtensible(){return!1},preventExtensions(){return!0},getOwnPropertyDescriptor(c,h){if(this.get(c,h,null))return Reflect.getOwnPropertyDescriptor(c,Ke(h))},has(c,h){return!!this.get(c,h,null)},ownKeys:c=>{let h=[...this.querySelectorAll("[id]")].map(T=>T.id),r=[...new Set(h)];return C&&h.length!==r.length&&I.log("Element contains multiple, shadowed decendant ids",r),r},get:(c,h,r)=>{if(typeof h=="string"){let T=Ke(h);if(T in c){let P=c[T].deref();if(P&&P.id===h&&this.contains(P))return P;delete c[T]}let d;if(C){let P=this.querySelectorAll("#"+CSS.escape(h));P.length>1&&(ye.has(h)||(ye.add(h),I.log(`Element contains multiple, shadowed decendants with ID "${h}"`))),d=P[0]}else d=this.querySelector("#"+CSS.escape(h))??void 0;return d&&Reflect.set(c,T,new WeakRef(d),c),d}}});return Object.defineProperty(this,"ids",{configurable:!0,enumerable:!0,set:oe,get(){return s}}),s}}});l&&k(b,l);function A(...s){let c=[];return function h(r){if(!(r==null||r===R)){if(X(r)){let T=p();c.push(T),r.then(d=>{let P=c.indexOf(T);if(P<0&&(I.warn("Replacement node not in array of appended nodes! This shouldn't be possible."),C))debugger;let Y=A(d);i.add(c[P]),c.splice(P,1,...Y),T.replaceWith(...Y)},d=>{I.warn(d,z(T)),T.replaceWith(g({error:d}))});return}if(r instanceof Node){c.push(r);return}if(r&&typeof r=="object"&&Symbol.iterator in r&&!(Symbol.asyncIterator in r)&&r[Symbol.iterator]){for(let T of r)h(T);return}if(Q(r)){let T=C?`
`+new Error().stack?.replace(/^Error: /,"Insertion :"):"",d=ae(r)?r:r[Symbol.asyncIterator](),P=r.valueOf(),Y=P===void 0||P===r?[]:A(P),m=Y.length?Y:[p()];c.push(...m);let f=x=>{let w=m.map(S=>c.indexOf(S)).sort((S,N)=>N-S);if(w[w.length-1]<0&&(I.warn("Replacement node not in array of appended nodes! This shouldn't be possible."),C))debugger;w.forEach(S=>{S>=0&&(i.add(c[S]),c.splice(S,1))}),x&&(x.length===0&&(x=[p()]),c.splice(Math.min(...w),0,...x)),m=x||[]},v=!0,O=Date.now()+J,V=C&&new Error("Created by").stack,Z=()=>d.next().then(x=>{if(!x.done){let w=m.filter(N=>N?.parentNode&&N.isConnected),S=v?m:w;if(v&&w.length&&(v=!1),!S.length||m.every(N=>i.has(N))){f(null);let N="Element(s) have been removed from the document: "+T;d.return?.(new Error(N));return}C&&v&&O&&O<Date.now()&&(O=Number.MAX_SAFE_INTEGER,I.warn(`Async element not mounted after ${J/1e3} seconds. If it is never mounted, it will leak.`,V,m.map(z))),f(A(se(x.value))),S[0].replaceWith(...m),S.forEach(N=>!m.includes(N)&&N.parentNode?.removeChild(N)),Z()}}).catch(x=>{let w=m.filter(S=>!!S?.parentNode);w.length?(f([g({error:x})]),w[0].replaceWith(...m),w.slice(1).forEach(S=>S?.parentNode.removeChild(S))):I.warn("Can't report error",x,V,m.map(z)),f(null),d.return?.(x)});Z();return}c.push(o.createTextNode(r.toString()))}}(s),c}a||Object.assign(st,{nodes:A,UniqueID:be});let K=Object.getPrototypeOf({});function k(s,c,h){if(!(c==null||typeof c!="object"||c===s))for(let[r,T]of Object.entries(Object.getOwnPropertyDescriptors(c)))try{if("value"in T){let d=T.value;d&&Q(d)?Object.defineProperty(s,r,T):d&&typeof d=="object"&&!X(d)?r in s?d instanceof Node?(I.info(`Having DOM Nodes as properties of other DOM Nodes is a bad idea as it makes the DOM tree into a cyclic graph. You should reference nodes by ID or via a collection such as .childNodes. Propety: '${r}' value: ${z(d)} destination: ${s instanceof Node?z(s):s}`),s[r]=d):s[r]!==d&&(Array.isArray(s[r])&&s[r].length!==d.length?d.constructor===Object||d.constructor===Array?k(s[r]=new d.constructor,d):s[r]=d:k(s[r],d)):(h&&(Object.getPrototypeOf(d)===K||!Object.getPrototypeOf(d)?k(T.value={},d):Array.isArray(d)?k(T.value=[],d):I.warn(`Declared propety '${r}' is not a plain object and must be assigned by reference, possibly polluting other instances of this tag`,s,d)),Object.defineProperty(s,r,T)):c[r]!==void 0&&(s[r]=c[r])}else Object.defineProperty(s,r,T)}catch(d){throw I.warn("deepAssign",r,c[r],d),d}}function se(s){let c=s?.valueOf();return Array.isArray(c)?Array.prototype.map.call(c,se):c}function L(s,c){ie in c||function h(r,T){if(T==null||typeof T!="object")return;let d=Object.entries(Object.getOwnPropertyDescriptors(T));Array.isArray(T)||d.sort(m=>{let f=Object.getOwnPropertyDescriptor(r,m[0]);if(f){if("value"in f)return-1;if("set"in f||"get"in f)return 1}return 0});for(let[m,f]of d)try{if("value"in f){let v=f.value;Q(v)?P(v,m):X(v)?v.then(O=>{O&&typeof O=="object"?Q(O)?P(O,m):Y(O,m):T[m]!==void 0&&(r[m]=O)},O=>I.log("Failed to set attribute",O)):Q(v)||(v&&typeof v=="object"&&!X(v)?Y(v,m):T[m]!==void 0&&(r[m]=T[m]))}else Object.defineProperty(r,m,f)}catch(v){throw I.warn("assignProps",m,T[m],v),v}function P(m,f){let v=Te(m),O=!0,V=Date.now()+J,Z=C&&new Error("Created by").stack,x=N=>{if(!N.done){let M=se(N.value);if(typeof M=="object"&&M!==null){let W=Object.getOwnPropertyDescriptor(r,f);f==="style"||!W?.set?h(r[f],M):r[f]=M}else M!==void 0&&(r[f]=M);let $=s.isConnected;if(i.has(s)||!O&&!$){I.info(`Element does not exist in document when setting async attribute '${f}' to:
${z(s)}`),v.return?.();return}$&&(O=!1),O&&V&&V<Date.now()&&(V=Number.MAX_SAFE_INTEGER,I.warn(`Element with async attribute '${f}' not mounted after ${J/1e3} seconds. If it is never mounted, it will leak.
Element contains: ${z(s)}
${Z}`)),v.next().then(x).catch(w)}},w=N=>{I.warn("Dynamic attribute error",N,f,r,Z,z(s)),v.return?.(N),s.appendChild(g({error:N}))},S=m.valueOf();S!==void 0&&S!==m&&!Q(S)?x({done:!1,value:S}):v.next().then(x).catch(w)}function Y(m,f){if(m instanceof Node)I.info(`Having DOM Nodes as properties of other DOM Nodes is a bad idea as it makes the DOM tree into a cyclic graph. You should reference nodes by ID or via a collection such as .childNodes. Propety: '${f}' value: ${z(m)} destination: ${s instanceof Node?z(s):s}`),r[f]=m;else if(!(f in r)||r[f]===m||Array.isArray(r[f])&&r[f].length!==m.length)if(m.constructor===Object||m.constructor===Array){let v=new m.constructor;h(v,m),r[f]=v}else r[f]=m;else Object.getOwnPropertyDescriptor(r,f)?.set?r[f]=m:h(r[f],m)}}(s,c)}function D(s){for(let c=s.constructor;c;c=c.super)if(c===this)return!0;return!1}function E(s){let c=typeof s!="function"?f=>Object.assign({},s,f):s,h=Date.now().toString(36)+(rt++).toString(36)+Math.random().toString(36).slice(2),r=c({[be]:h});r.styles&&(B.appendChild(o.createTextNode(r.styles+`
`)),o.head.contains(B)||o.head.appendChild(B));let d=Object.assign((f,...v)=>{let O=me(f),V=[],Z={[ie]:(O?V:f[ie])??V},x=O?this(Z,f,...v):this(Z,...v);x.constructor=d;let w=c({[be]:h});if(Z[ie].push(w),C){let M=function($,W){for(let U=$;U;U=U.super)if(U.definition?.declare&&W in U.definition.declare)return!0;return!1};var N=M;if(w.declare){let $=Object.keys(w.declare).filter(W=>W in x||M(this,W));$.length&&I.log(`Declared keys '${$}' in ${d.name} already exist in base '${this.valueOf()}'`)}if(w.override){let $=Object.keys(w.override).filter(W=>!(W in x)&&!(l&&W in l)&&!M(this,W));$.length&&I.log(`Overridden keys '${$}' in ${d.name} do not exist in base '${this.valueOf()}'`)}}k(x,w.declare,!0),k(x,w.override);let S=new Set;if(w.iterable&&Object.keys(w.iterable).forEach(M=>{M in x?(I.log(`Ignoring attempt to re-define iterable property "${M}" as it could already have consumers`),S.add(M)):ve(x,M,w.iterable[M])}),Z[ie]===V){O||L(x,f);for(let W of V){let U=W?.constructed?.call(x);me(U)&&x.append(...A(U))}let M={},$=!1;for(let W of V)if(W.iterable)for(let U of Object.keys(W.iterable)){let Oe=!O&&U in f;if(S.has(U)&&Oe||!(Oe&&(!X(f[U])||!Q(f[U])))){let we=x[U]?.valueOf();we!==void 0&&(M[U]=we,$=!0)}}$&&Object.assign(x,M)}return x},{super:this,definition:Object.assign(r,{[be]:h}),extended:E,valueOf:()=>{let f=[...Object.keys(r.declare||{}),...Object.keys(r.iterable||{})];return`${d.name}: {${f.join(", ")}}
 \u21AA ${this.valueOf()}`}});Object.defineProperty(d,Symbol.hasInstance,{value:D,writable:!0,configurable:!0});let P={};(function f(v){v?.super&&f(v.super);let O=v.definition;O&&(k(P,O?.override),k(P,O?.declare))})(this),k(P,r.override),k(P,r.declare),Object.defineProperties(d,Object.getOwnPropertyDescriptors(P));let Y=P&&"className"in P&&typeof P.className=="string"?P.className:h,m=C?new Error().stack?.split(`
`)[2]??"":"";if(Object.defineProperty(d,"name",{value:"<ai-"+Y.replace(/\s+/g,"-")+m+">"}),C){let f=Object.keys(r).filter(v=>!["styles","ids","constructed","declare","override","iterable"].includes(v));f.length&&I.log(`${d.name} defines extraneous keys '${f}', which are unknown`)}return d}let F={createElement(s,c,...h){return s===F.createElement?A(...h):typeof s=="function"?s(c,h):typeof s=="string"&&s in F?F[s](c,h):s instanceof Node?s:g({error:new Error("Illegal type in createElement:"+s)})}};function j(s){if(F[s])return F[s];let c=(r,...T)=>{if(me(r)&&(T.unshift(r),r={}),!me(r)){if(r.debugger){debugger;delete r.debugger}let d=a?o.createElementNS(a,s.toLowerCase()):o.createElement(s);return d.constructor=c,k(d,b),L(d,r),d.append(...A(...T)),d}},h=Object.assign(c,{super:()=>{throw new Error("Can't invoke native elemenet constructors directly. Use document.createElement().")},extended:E,valueOf(){return`TagCreator: <${a||""}${a?"::":""}${s}>`}});return Object.defineProperty(c,Symbol.hasInstance,{value:D,writable:!0,configurable:!0}),Object.defineProperty(c,"name",{value:"<"+s+">"}),F[s]=h}return u.forEach(j),F};function at(e,t,n){let a=new WeakSet;function u(y){for(let l of y)t==="addedNodes"===l.isConnected&&(u(l.childNodes),a.add(l),n&&"onRemovedFromDOM"in l&&typeof l.onRemovedFromDOM=="function"&&l.onRemovedFromDOM())}return new MutationObserver(y=>{y.forEach(function(l){l.type==="childList"&&l[t].length&&u(l[t])})}).observe(e,{subtree:!0,childList:!0}),a}export{Re as Iterators,be as UniqueID,st as tag,Ce as when};
